nohup: ignoring input
<ast>:17: RuntimeWarning: overflow encountered in exp
/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_numdiff.py:596: RuntimeWarning: invalid value encountered in subtract
  df = fun(x1) - f0
<ast>:17: RuntimeWarning: overflow encountered in exp
<ast>:3: RuntimeWarning: overflow encountered in exp
/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_numdiff.py:596: RuntimeWarning: invalid value encountered in subtract
  df = fun(x1) - f0
<ast>:3: RuntimeWarning: overflow encountered in exp
/workspaces/mictlan/research/funsearch/examples/npda_numpy.py:26: RuntimeWarning: overflow encountered in square
  return np.mean((y_pred - outputs) ** 2)
<ast>:3: RuntimeWarning: overflow encountered in exp
/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_numdiff.py:596: RuntimeWarning: invalid value encountered in subtract
  df = fun(x1) - f0
<ast>:3: RuntimeWarning: overflow encountered in exp
<ast>:3: RuntimeWarning: overflow encountered in exp
/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_numdiff.py:596: RuntimeWarning: invalid value encountered in subtract
  df = fun(x1) - f0
<ast>:3: RuntimeWarning: overflow encountered in exp
/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_numdiff.py:596: RuntimeWarning: invalid value encountered in subtract
  df = fun(x1) - f0
<ast>:3: RuntimeWarning: overflow encountered in exp
Error during mutation/evaluation for island 0x7f205bd91dc0: ('Unicode escape decoding failed.\n', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    \\"\\"\\')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/llmsr/code_manipulation.py", line 9, in fix_wrong_escape
    code = code.encode("utf-8").decode("unicode_escape")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeDecodeError: 'unicodeescape' codec can't decode byte 0x5c in position 102: \ at end of string
decoding with 'unicode_escape' codec failed

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 258, in request_mutation
    new_fn = self._mutation_engine.mutate(sample_fns)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/llmsr/py_mutation_engine.py", line 79, in mutate
    fn_code = self._parse_answer(answer, str(skeletons[0]))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/llmsr/py_mutation_engine.py", line 122, in _parse_answer
    answer = fix_wrong_escape(answer)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/llmsr/code_manipulation.py", line 12, in fix_wrong_escape
    raise ValueError("Unicode escape decoding failed.\n", code) from e
ValueError: ('Unicode escape decoding failed.\n', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    \\"\\"\\')
<ast>:5: RuntimeWarning: overflow encountered in exp
/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_numdiff.py:596: RuntimeWarning: invalid value encountered in subtract
  df = fun(x1) - f0
Error during mutation/evaluation for island 0x7f205b8f27b0: ('Unicode escape decoding failed.\n', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\\n    \\')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/llmsr/code_manipulation.py", line 9, in fix_wrong_escape
    code = code.encode("utf-8").decode("unicode_escape")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeDecodeError: 'unicodeescape' codec can't decode byte 0x5c in position 99: \ at end of string
decoding with 'unicode_escape' codec failed

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 258, in request_mutation
    new_fn = self._mutation_engine.mutate(sample_fns)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/llmsr/py_mutation_engine.py", line 79, in mutate
    fn_code = self._parse_answer(answer, str(skeletons[0]))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/llmsr/py_mutation_engine.py", line 122, in _parse_answer
    answer = fix_wrong_escape(answer)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/llmsr/code_manipulation.py", line 12, in fix_wrong_escape
    raise ValueError("Unicode escape decoding failed.\n", code) from e
ValueError: ('Unicode escape decoding failed.\n', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\\n    \\')
/workspaces/mictlan/research/funsearch/examples/npda_numpy.py:26: RuntimeWarning: overflow encountered in square
  return np.mean((y_pred - outputs) ** 2)
/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_numdiff.py:596: RuntimeWarning: invalid value encountered in subtract
  df = fun(x1) - f0
<ast>:5: RuntimeWarning: overflow encountered in exp
/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_numdiff.py:596: RuntimeWarning: invalid value encountered in subtract
  df = fun(x1) - f0
<ast>:5: RuntimeWarning: overflow encountered in exp
/workspaces/mictlan/research/funsearch/examples/npda_numpy.py:26: RuntimeWarning: overflow encountered in square
  return np.mean((y_pred - outputs) ** 2)
/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_numdiff.py:596: RuntimeWarning: invalid value encountered in subtract
  df = fun(x1) - f0
Error during mutation/evaluation for island 0x7f205b866600: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Introduce a more sophisticated phase term to account for non-linear effects in QPM\n    phase_term = params[2] * np.cos(params[3] * width / wavelength) + params[8] * np.sin(2 * params[3] * width / wavelength)\n    # Include amplitude modulation with Gaussian profile and additional harmonic term\n    amplitude_modulation = (params[4] + params[9]) * np.exp(-((width - params[5]) ** 2) / (2 * params[6] ** 2))\n    sinc_term = np.sinc((params[0] + phase_term + amplitude_modulation) * width / wavelength)\n    # Apply a correction factor to account for temperature effects on SHG efficiency\n    temperature_correction = params[10] * np.exp(-params[11] * (wavelength - params[12]) ** 2)\n    efficiency = params[1] * (sinc_term ** 2) + params[7] + temperature_correction\n    return efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 8, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Introduce a more sophisticated phase term to account for non-linear effects in QPM\n    phase_term = params[2] * np.cos(params[3] * width / wavelength) + params[8] * np.sin(2 * params[3] * width / wavelength)\n    # Include amplitude modulation with Gaussian profile and additional harmonic term\n    amplitude_modulation = (params[4] + params[9]) * np.exp(-((width - params[5]) ** 2) / (2 * params[6] ** 2))\n    sinc_term = np.sinc((params[0] + phase_term + amplitude_modulation) * width / wavelength)\n    # Apply a correction factor to account for temperature effects on SHG efficiency\n    temperature_correction = params[10] * np.exp(-params[11] * (wavelength - params[12]) ** 2)\n    efficiency = params[1] * (sinc_term ** 2) + params[7] + temperature_correction\n    return efficiency')
Error during mutation/evaluation for island 0x7f206117b170: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the phase matching condition with an enhanced quadratic term\n    k = (2 * np.pi / wavelength) + (2 * np.pi * params[0] / width) + (params[1] * (width ** 2))\n    # Introduce a more complex modulation factor that includes higher-order sinusoidal terms\n    modulation_factor = 1 + params[2] * np.sin(2 * np.pi * params[3] * width / wavelength) + params[4] * np.cos(4 * np.pi * params[5] * width / wavelength) + params[6] * np.sin(6 * np.pi * params[7] * width / wavelength)\n    # Calculate the sinc-like term using domain width, wavelength, and modulation factor\n    sinc_term = np.sinc(k - params[8]) * modulation_factor\n    # Apply a Gaussian envelope with an adjustable width to enhance the localization of the SHG efficiency\n    gaussian_envelope = np.exp(-((width - params[9])**2) / (2 * (params[10] ** 2)))\n    # Calculate SHG efficiency proportional to the square of the modified sinc term and Gaussian envelope, with an additional linear term for baseline adjustment\n    shg_efficiency = params[11] * sinc_term**2 * gaussian_envelope + params[12]\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 9, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the phase matching condition with an enhanced quadratic term\n    k = (2 * np.pi / wavelength) + (2 * np.pi * params[0] / width) + (params[1] * (width ** 2))\n    # Introduce a more complex modulation factor that includes higher-order sinusoidal terms\n    modulation_factor = 1 + params[2] * np.sin(2 * np.pi * params[3] * width / wavelength) + params[4] * np.cos(4 * np.pi * params[5] * width / wavelength) + params[6] * np.sin(6 * np.pi * params[7] * width / wavelength)\n    # Calculate the sinc-like term using domain width, wavelength, and modulation factor\n    sinc_term = np.sinc(k - params[8]) * modulation_factor\n    # Apply a Gaussian envelope with an adjustable width to enhance the localization of the SHG efficiency\n    gaussian_envelope = np.exp(-((width - params[9])**2) / (2 * (params[10] ** 2)))\n    # Calculate SHG efficiency proportional to the square of the modified sinc term and Gaussian envelope, with an additional linear term for baseline adjustment\n    shg_efficiency = params[11] * sinc_term**2 * gaussian_envelope + params[12]\n    return shg_efficiency')
<ast>:5: RuntimeWarning: overflow encountered in exp
/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_numdiff.py:596: RuntimeWarning: invalid value encountered in subtract
  df = fun(x1) - f0
Error during mutation/evaluation for island 0x7f205b3528a0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Advanced SHG efficiency calculation with improved phase shift term, frequency modulation, and a more precise sinc-like function\n    sinc_term = np.sinc((wavelength - params[0]) / (2 * params[1]))\n    phase_shift = 2 * np.pi * params[2] * width + params[3] * wavelength + params[4] * np.sin(params[5] * wavelength) + params[6] * np.cos(params[7] * width)\n    envelope_term = np.exp(-params[8] * (width - params[9])**2)  # Gaussian envelope to model the finite width of the modulation depth\n    efficiency = np.square(sinc_term) * np.cos(phase_shift) * params[10]\n    return efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 6, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Advanced SHG efficiency calculation with improved phase shift term, frequency modulation, and a more precise sinc-like function\n    sinc_term = np.sinc((wavelength - params[0]) / (2 * params[1]))\n    phase_shift = 2 * np.pi * params[2] * width + params[3] * wavelength + params[4] * np.sin(params[5] * wavelength) + params[6] * np.cos(params[7] * width)\n    envelope_term = np.exp(-params[8] * (width - params[9])**2)  # Gaussian envelope to model the finite width of the modulation depth\n    efficiency = np.square(sinc_term) * np.cos(phase_shift) * params[10]\n    return efficiency')
Error during mutation/evaluation for island 0x7f205b3216d0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the fundamental frequency mismatch parameter\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    # Define the sinc-like function component with phase shift consideration and additional normalization factor\n    phase_shift = params[1]\n    normalization_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (normalization_factor * params[3]))\n    # Calculate the SHG efficiency using a more physically accurate formula with temperature-dependent correction\n    temperature_correction = 1 + params[4] * (params[5] - 273.15)\n    shg_efficiency = params[6] * sinc_component**2 * temperature_correction + params[7] * width**(-params[8]) + params[9] * wavelength**(-params[10])\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 10, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the fundamental frequency mismatch parameter\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    # Define the sinc-like function component with phase shift consideration and additional normalization factor\n    phase_shift = params[1]\n    normalization_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (normalization_factor * params[3]))\n    # Calculate the SHG efficiency using a more physically accurate formula with temperature-dependent correction\n    temperature_correction = 1 + params[4] * (params[5] - 273.15)\n    shg_efficiency = params[6] * sinc_component**2 * temperature_correction + params[7] * width**(-params[8]) + params[9] * wavelength**(-params[10])\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f205b3528a0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Incorporating an additional phase modulation term to account for dispersion effects\n    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)\n    sinc_term = np.sinc(normalized_wavelength)\n    primary_phase_shift = 2 * np.pi * params[2] * width + params[3] * wavelength + params[4] * np.sin(params[5] * wavelength)\n    secondary_phase_shift = params[6] * np.exp(-params[7] * (wavelength - params[8])**2)  # Exponential modulation for dispersion correction\n    envelope_term = np.exp(-params[9] * (width - params[10])**2) * np.cos(2 * np.pi * params[11] * wavelength)\n    efficiency = np.square(sinc_term) * np.cos(primary_phase_shift + secondary_phase_shift) * params[12] * envelope_term\n    return efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 7, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Incorporating an additional phase modulation term to account for dispersion effects\n    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)\n    sinc_term = np.sinc(normalized_wavelength)\n    primary_phase_shift = 2 * np.pi * params[2] * width + params[3] * wavelength + params[4] * np.sin(params[5] * wavelength)\n    secondary_phase_shift = params[6] * np.exp(-params[7] * (wavelength - params[8])**2)  # Exponential modulation for dispersion correction\n    envelope_term = np.exp(-params[9] * (width - params[10])**2) * np.cos(2 * np.pi * params[11] * wavelength)\n    efficiency = np.square(sinc_term) * np.cos(primary_phase_shift + secondary_phase_shift) * params[12] * envelope_term\n    return efficiency')
/workspaces/mictlan/research/funsearch/examples/npda_numpy.py:26: RuntimeWarning: overflow encountered in square
  return np.mean((y_pred - outputs) ** 2)
/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_numdiff.py:596: RuntimeWarning: invalid value encountered in subtract
  df = fun(x1) - f0
Error during mutation/evaluation for island 0x7f205b8f27b0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Normalize the width based on a parameter\n    normalized_width = width / params[0]\n    # Calculate the phase mismatch term using another parameter and incorporate a physical factor for dispersion\n    phase_mismatch = params[1] * (wavelength - params[2]) + params[3] * wavelength ** (-2)\n    # Compute the sinc function adjusted by the phase mismatch and a damping factor, including a physical correction factor\n    sinc_term = np.sinc(normalized_width + phase_mismatch) * np.exp(-((wavelength - params[4]) / params[5]) ** 2)\n    # Calculate SHG efficiency, incorporating an additional factor for physical accuracy and accounting for the nonlinear refractive index effect with a more precise model\n    non_linear_effect = np.tanh(params[6] * (wavelength - params[7])) + params[8] * wavelength ** (-4)\n    efficiency = ((sinc_term ** 2) / ((wavelength - params[9]) ** 2 + params[10] ** 2)) * non_linear_effect\n    return efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 10, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Normalize the width based on a parameter\n    normalized_width = width / params[0]\n    # Calculate the phase mismatch term using another parameter and incorporate a physical factor for dispersion\n    phase_mismatch = params[1] * (wavelength - params[2]) + params[3] * wavelength ** (-2)\n    # Compute the sinc function adjusted by the phase mismatch and a damping factor, including a physical correction factor\n    sinc_term = np.sinc(normalized_width + phase_mismatch) * np.exp(-((wavelength - params[4]) / params[5]) ** 2)\n    # Calculate SHG efficiency, incorporating an additional factor for physical accuracy and accounting for the nonlinear refractive index effect with a more precise model\n    non_linear_effect = np.tanh(params[6] * (wavelength - params[7])) + params[8] * wavelength ** (-4)\n    efficiency = ((sinc_term ** 2) / ((wavelength - params[9]) ** 2 + params[10] ** 2)) * non_linear_effect\n    return efficiency')
/workspaces/mictlan/research/funsearch/examples/npda_numpy.py:26: RuntimeWarning: overflow encountered in square
  return np.mean((y_pred - outputs) ** 2)
/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_numdiff.py:596: RuntimeWarning: invalid value encountered in subtract
  df = fun(x1) - f0
Error during mutation/evaluation for island 0x7f2067db53d0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k = 2 * np.pi / wavelength\n    phase_match_term = np.sin(k * width - params[0])\n    sinc_term = np.sinc(phase_match_term / (params[1] * np.pi))\n    gaussian_factor = np.exp(-width**2 / (2 * params[3]**2))\n    temperature_effect = np.exp(-params[5] * (wavelength - params[6])**2)\n    # Adjusting the nonlinearity factor to include a more physical representation of SHG efficiency\n    nonlinearity_factor = np.sin(params[8] * phase_match_term + params[9])**2 + params[10]\n    shg_efficiency = np.square(sinc_term) * gaussian_factor * temperature_effect * nonlinearity_factor * params[7]\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 8, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k = 2 * np.pi / wavelength\n    phase_match_term = np.sin(k * width - params[0])\n    sinc_term = np.sinc(phase_match_term / (params[1] * np.pi))\n    gaussian_factor = np.exp(-width**2 / (2 * params[3]**2))\n    temperature_effect = np.exp(-params[5] * (wavelength - params[6])**2)\n    # Adjusting the nonlinearity factor to include a more physical representation of SHG efficiency\n    nonlinearity_factor = np.sin(params[8] * phase_match_term + params[9])**2 + params[10]\n    shg_efficiency = np.square(sinc_term) * gaussian_factor * temperature_effect * nonlinearity_factor * params[7]\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f205b3528a0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Improved SHG efficiency calculation with enhanced phase modulation and frequency correction\n    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)\n    sinc_term = np.sinc(normalized_wavelength)**2\n    phase_shift = 2 * np.pi * params[2] * width + params[3] * wavelength + params[4] * np.sin(params[5] * wavelength) + params[9] * np.cos(params[10] * wavelength)\n    envelope_term = np.exp(-params[6] * (width - params[7])**2) * np.cos(2 * np.pi * params[8] * wavelength)**2\n    efficiency = sinc_term * np.cos(phase_shift)**2 * params[11]\n    return efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 5, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Improved SHG efficiency calculation with enhanced phase modulation and frequency correction\n    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)\n    sinc_term = np.sinc(normalized_wavelength)**2\n    phase_shift = 2 * np.pi * params[2] * width + params[3] * wavelength + params[4] * np.sin(params[5] * wavelength) + params[9] * np.cos(params[10] * wavelength)\n    envelope_term = np.exp(-params[6] * (width - params[7])**2) * np.cos(2 * np.pi * params[8] * wavelength)**2\n    efficiency = sinc_term * np.cos(phase_shift)**2 * params[11]\n    return efficiency')
Error during mutation/evaluation for island 0x7f205b3216d0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the fundamental frequency mismatch parameter\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    # Define the sinc-like function component with phase shift and broadening consideration\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    # Calculate the SHG efficiency using a more physically accurate formula, considering nonlinear effects and domain width modulation\n    shg_efficiency = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2)) + params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8]) * np.cos(params[9] * k_mismatch) + params[10] * np.sin(params[11] * k_mismatch)\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 9, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the fundamental frequency mismatch parameter\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    # Define the sinc-like function component with phase shift and broadening consideration\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    # Calculate the SHG efficiency using a more physically accurate formula, considering nonlinear effects and domain width modulation\n    shg_efficiency = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2)) + params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8]) * np.cos(params[9] * k_mismatch) + params[10] * np.sin(params[11] * k_mismatch)\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f205b8f27b0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    normalized_width = width / params[0]\n    phase_mismatch = params[1] * (wavelength - params[2])\n    sinc_term = np.sinc(normalized_width + phase_mismatch) * np.exp(-((wavelength - params[3]) / params[4]) ** 2)\n    non_linear_effect = np.tanh(params[5] * (wavelength - params[6]))\n    dispersion_compensation = np.cos(params[7] * wavelength**2 + params[8])\n    efficiency = ((sinc_term ** 2) / ((wavelength - params[9]) ** 2 + params[10] ** 2)) * non_linear_effect * dispersion_compensation\n    return efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 7, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    normalized_width = width / params[0]\n    phase_mismatch = params[1] * (wavelength - params[2])\n    sinc_term = np.sinc(normalized_width + phase_mismatch) * np.exp(-((wavelength - params[3]) / params[4]) ** 2)\n    non_linear_effect = np.tanh(params[5] * (wavelength - params[6]))\n    dispersion_compensation = np.cos(params[7] * wavelength**2 + params[8])\n    efficiency = ((sinc_term ** 2) / ((wavelength - params[9]) ** 2 + params[10] ** 2)) * non_linear_effect * dispersion_compensation\n    return efficiency')
Error during mutation/evaluation for island 0x7f205b8f27b0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    normalized_width = width / (params[0] * wavelength)\n    phase_mismatch = params[1] * np.sin(2 * np.pi * (wavelength - params[2]) / params[3])\n    damping_factor = np.exp(-((wavelength - params[4]) / params[5]) ** 2)\n    physical_correction = params[6] + params[7] * normalized_width\n    sinc_term = np.sinc(normalized_width + phase_mismatch + physical_correction) * damping_factor\n    non_linear_effect = np.tanh(params[8] * (wavelength - params[9]))\n    efficiency = ((sinc_term ** 2) / ((wavelength - params[10]) ** 2 + params[11] ** 2)) * non_linear_effect\n    return efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 8, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    normalized_width = width / (params[0] * wavelength)\n    phase_mismatch = params[1] * np.sin(2 * np.pi * (wavelength - params[2]) / params[3])\n    damping_factor = np.exp(-((wavelength - params[4]) / params[5]) ** 2)\n    physical_correction = params[6] + params[7] * normalized_width\n    sinc_term = np.sinc(normalized_width + phase_mismatch + physical_correction) * damping_factor\n    non_linear_effect = np.tanh(params[8] * (wavelength - params[9]))\n    efficiency = ((sinc_term ** 2) / ((wavelength - params[10]) ** 2 + params[11] ** 2)) * non_linear_effect\n    return efficiency')
Error during mutation/evaluation for island 0x7f205b8f27b0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Normalize width based on a parameter considering physical dimensions\n    normalized_width = width / (params[0] * wavelength)\n    \n    # Calculate phase mismatch term with a sinusoidal component for periodic structures\n    phase_mismatch = params[1] * np.sin(2 * np.pi * (wavelength - params[2]) / params[3])\n    \n    # Compute sinc function adjusted by the phase mismatch and a damping factor, enhancing physical accuracy\n    sinc_term = np.sinc(normalized_width + phase_mismatch) * np.exp(-((wavelength - params[4]) ** 2) / (2 * (params[5] ** 2)))\n    \n    # Nonlinear effect considering temperature variations and material properties\n    non_linear_effect = np.tanh(params[6] * (wavelength - params[7])) + params[8]\n    \n    # Efficiency calculation, incorporating an additional factor for physical accuracy\n    efficiency = ((sinc_term ** 2) / ((wavelength - params[9]) ** 2 + params[10] ** 2)) * non_linear_effect\n    return efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 15, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Normalize width based on a parameter considering physical dimensions\n    normalized_width = width / (params[0] * wavelength)\n    \n    # Calculate phase mismatch term with a sinusoidal component for periodic structures\n    phase_mismatch = params[1] * np.sin(2 * np.pi * (wavelength - params[2]) / params[3])\n    \n    # Compute sinc function adjusted by the phase mismatch and a damping factor, enhancing physical accuracy\n    sinc_term = np.sinc(normalized_width + phase_mismatch) * np.exp(-((wavelength - params[4]) ** 2) / (2 * (params[5] ** 2)))\n    \n    # Nonlinear effect considering temperature variations and material properties\n    non_linear_effect = np.tanh(params[6] * (wavelength - params[7])) + params[8]\n    \n    # Efficiency calculation, incorporating an additional factor for physical accuracy\n    efficiency = ((sinc_term ** 2) / ((wavelength - params[9]) ** 2 + params[10] ** 2)) * non_linear_effect\n    return efficiency')
Error during mutation/evaluation for island 0x7f206117b170: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the phase mismatch\n    k_mismatch = (2 * np.pi / wavelength) - (2 * np.pi * params[0] / width)\n    \n    # Modulation factor with a more complex dependence on width and wavelength\n    modulation_factor = 1 + params[1] * np.sin(2 * np.pi * params[2] * width / wavelength) + params[3] * np.cos(4 * np.pi * params[4] * width / wavelength) + params[5] * np.tan(params[6] * k_mismatch)\n    \n    # Sinc term with an additional phase shift\n    sinc_term = np.sinc(k_mismatch - params[7]) * modulation_factor\n    \n    # Gaussian envelope for better localization\n    gaussian_envelope = np.exp(-((width - params[8])**2) / (2 * (params[9]**2)))\n    \n    # SHG efficiency as the square of sinc term multiplied by Gaussian envelope and a scaling factor\n    shg_efficiency = params[10] * sinc_term**2 * gaussian_envelope + params[11]\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 15, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the phase mismatch\n    k_mismatch = (2 * np.pi / wavelength) - (2 * np.pi * params[0] / width)\n    \n    # Modulation factor with a more complex dependence on width and wavelength\n    modulation_factor = 1 + params[1] * np.sin(2 * np.pi * params[2] * width / wavelength) + params[3] * np.cos(4 * np.pi * params[4] * width / wavelength) + params[5] * np.tan(params[6] * k_mismatch)\n    \n    # Sinc term with an additional phase shift\n    sinc_term = np.sinc(k_mismatch - params[7]) * modulation_factor\n    \n    # Gaussian envelope for better localization\n    gaussian_envelope = np.exp(-((width - params[8])**2) / (2 * (params[9]**2)))\n    \n    # SHG efficiency as the square of sinc term multiplied by Gaussian envelope and a scaling factor\n    shg_efficiency = params[10] * sinc_term**2 * gaussian_envelope + params[11]\n    return shg_efficiency')
<ast>:5: RuntimeWarning: overflow encountered in exp
/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_numdiff.py:596: RuntimeWarning: invalid value encountered in subtract
  df = fun(x1) - f0
<ast>:5: RuntimeWarning: overflow encountered in exp
<ast>:5: RuntimeWarning: overflow encountered in exp
/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_numdiff.py:596: RuntimeWarning: invalid value encountered in subtract
  df = fun(x1) - f0
<ast>:5: RuntimeWarning: overflow encountered in exp
/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_numdiff.py:596: RuntimeWarning: invalid value encountered in subtract
  df = fun(x1) - f0
<ast>:5: RuntimeWarning: overflow encountered in exp
Error during mutation/evaluation for island 0x7f205b866600: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Adding a phase modulation term that includes both sine and cosine components\n    phase_modulation = (params[0] * np.sin(params[1] * width / wavelength) + params[2] * np.cos(params[3] * width / wavelength))\n    \n    # Adjusting the amplitude envelope to include a linear variation with width for better matching\n    amplitude_envelope = params[4] * (1 + params[5] * width) * np.exp(-((width - params[6]) ** 2) / (2 * params[7] ** 2))\n    \n    # Introducing a frequency modulation that is a combination of sine and cosine, enhancing the matching\n    frequency_modulation = (params[8] * np.sin(params[9] * width / wavelength) + params[10] * np.cos(params[11] * width / wavelength))\n    \n    # Combining all modulation terms to form the combined term\n    combined_term = phase_modulation + amplitude_envelope + frequency_modulation\n    \n    # Creating a sinc argument that includes an additional parameter for fine tuning\n    sinc_argument = (combined_term - params[12]) / (params[13] * wavelength)\n    \n    # Calculating the sinc term based on the adjusted argument\n    sinc_term = np.sinc(sinc_argument)\n    \n    # Defining the efficiency as a function of the squared sinc term, scaled by a factor and offset\n    efficiency = params[14] * (sinc_term ** 2) + params[15]\n    return efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 9, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Adding a phase modulation term that includes both sine and cosine components\n    phase_modulation = (params[0] * np.sin(params[1] * width / wavelength) + params[2] * np.cos(params[3] * width / wavelength))\n    \n    # Adjusting the amplitude envelope to include a linear variation with width for better matching\n    amplitude_envelope = params[4] * (1 + params[5] * width) * np.exp(-((width - params[6]) ** 2) / (2 * params[7] ** 2))\n    \n    # Introducing a frequency modulation that is a combination of sine and cosine, enhancing the matching\n    frequency_modulation = (params[8] * np.sin(params[9] * width / wavelength) + params[10] * np.cos(params[11] * width / wavelength))\n    \n    # Combining all modulation terms to form the combined term\n    combined_term = phase_modulation + amplitude_envelope + frequency_modulation\n    \n    # Creating a sinc argument that includes an additional parameter for fine tuning\n    sinc_argument = (combined_term - params[12]) / (params[13] * wavelength)\n    \n    # Calculating the sinc term based on the adjusted argument\n    sinc_term = np.sinc(sinc_argument)\n    \n    # Defining the efficiency as a function of the squared sinc term, scaled by a factor and offset\n    efficiency = params[14] * (sinc_term ** 2) + params[15]\n    return efficiency')
Error during mutation/evaluation for island 0x7f205b3216d0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    gaussian_term = np.exp(-(width - params[4])**2 / (2 * params[5]**2))\n    shg_efficiency = params[3] * sinc_component**2 * gaussian_term + params[6] * wavelength**(-params[7]) + params[8] * width**(-params[9]) + params[10] * k_mismatch**2\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 7, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    gaussian_term = np.exp(-(width - params[4])**2 / (2 * params[5]**2))\n    shg_efficiency = params[3] * sinc_component**2 * gaussian_term + params[6] * wavelength**(-params[7]) + params[8] * width**(-params[9]) + params[10] * k_mismatch**2\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f205b3528a0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)\n    sinc_term = np.sinc(normalized_wavelength)**2\n    phase_shift = 2 * np.pi * (params[2] * width + params[3] * wavelength) + params[4] * np.sin(params[5] * wavelength)\n    envelope_term = np.exp(-params[6] * (width - params[7])**2) * np.cos(2 * np.pi * params[8] * wavelength)**2\n    efficiency = sinc_term * np.cos(phase_shift + params[9])**2 * np.exp(params[10])\n    return efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 6, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)\n    sinc_term = np.sinc(normalized_wavelength)**2\n    phase_shift = 2 * np.pi * (params[2] * width + params[3] * wavelength) + params[4] * np.sin(params[5] * wavelength)\n    envelope_term = np.exp(-params[6] * (width - params[7])**2) * np.cos(2 * np.pi * params[8] * wavelength)**2\n    efficiency = sinc_term * np.cos(phase_shift + params[9])**2 * np.exp(params[10])\n    return efficiency')
<ast>:13: RuntimeWarning: overflow encountered in power
/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_numdiff.py:596: RuntimeWarning: invalid value encountered in subtract
  df = fun(x1) - f0
/workspaces/mictlan/research/funsearch/examples/npda_numpy.py:26: RuntimeWarning: overflow encountered in square
  return np.mean((y_pred - outputs) ** 2)
Error during mutation/evaluation for island 0x7f2067db53d0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k = 2 * np.pi / wavelength\n    phase_match_term = np.sin(k * width - params[0])\n    sinc_term = np.sinc(phase_match_term / (params[1] * np.pi))\n    gaussian_factor = np.exp(-width**2 / (2 * params[3]**2))\n    temperature_effect = np.exp(-params[5] * (wavelength - params[6])**2)\n    nonlinearity_factor = np.sin(params[8] * phase_match_term + params[9]) ** 2\n    phase_modulation = np.cos(2 * k * width - params[10])\n    shg_efficiency = np.square(sinc_term) * gaussian_factor * temperature_effect * nonlinearity_factor * phase_modulation * params[7]\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 8, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k = 2 * np.pi / wavelength\n    phase_match_term = np.sin(k * width - params[0])\n    sinc_term = np.sinc(phase_match_term / (params[1] * np.pi))\n    gaussian_factor = np.exp(-width**2 / (2 * params[3]**2))\n    temperature_effect = np.exp(-params[5] * (wavelength - params[6])**2)\n    nonlinearity_factor = np.sin(params[8] * phase_match_term + params[9]) ** 2\n    phase_modulation = np.cos(2 * k * width - params[10])\n    shg_efficiency = np.square(sinc_term) * gaussian_factor * temperature_effect * nonlinearity_factor * phase_modulation * params[7]\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f206117b170: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the wavevector mismatch\n    k_mismatch = (2 * np.pi / wavelength) - (2 * np.pi * params[0] / width)\n    \n    # Introduce a more complex modulation factor that depends on both width and wavelength\n    modulation_factor = 1 + params[1] * np.sin(2 * np.pi * params[2] * width / wavelength) + params[3] * np.cos(4 * np.pi * params[4] * width / wavelength) + params[5] * np.tan(params[6] * k_mismatch)\n    \n    # Calculate the sinc-like term using domain width, wavelength, and modulation factor\n    sinc_term = np.sinc(k_mismatch - params[7]) * modulation_factor\n    \n    # Apply a Gaussian envelope to enhance the localization of the SHG efficiency, with an adjustable exponent for better fit\n    gaussian_envelope = np.exp(-((width - params[8])**2) / (2 * (params[9]**2)))\n    \n    # Calculate SHG efficiency proportional to the square of the modified sinc term and Gaussian envelope\n    shg_efficiency = params[10] * sinc_term**2 * gaussian_envelope + params[11]\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 15, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the wavevector mismatch\n    k_mismatch = (2 * np.pi / wavelength) - (2 * np.pi * params[0] / width)\n    \n    # Introduce a more complex modulation factor that depends on both width and wavelength\n    modulation_factor = 1 + params[1] * np.sin(2 * np.pi * params[2] * width / wavelength) + params[3] * np.cos(4 * np.pi * params[4] * width / wavelength) + params[5] * np.tan(params[6] * k_mismatch)\n    \n    # Calculate the sinc-like term using domain width, wavelength, and modulation factor\n    sinc_term = np.sinc(k_mismatch - params[7]) * modulation_factor\n    \n    # Apply a Gaussian envelope to enhance the localization of the SHG efficiency, with an adjustable exponent for better fit\n    gaussian_envelope = np.exp(-((width - params[8])**2) / (2 * (params[9]**2)))\n    \n    # Calculate SHG efficiency proportional to the square of the modified sinc term and Gaussian envelope\n    shg_efficiency = params[10] * sinc_term**2 * gaussian_envelope + params[11]\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f205b3528a0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Optimized SHG efficiency model with refined phase modulation and amplitude scaling\n    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)\n    sinc_term = np.sinc(normalized_wavelength)**2  # Squaring the sinc term for enhanced interference effect\n    phase_shift = 2 * np.pi * (params[2] * width + params[3] * wavelength) + params[4] * np.sin(params[5] * wavelength)\n    envelope_term = np.exp(-params[6] * (width - params[7])**2) * np.cos(2 * np.pi * params[8] * wavelength)**2  # Double the cosine term for stronger modulation\n    efficiency = sinc_term * np.cos(phase_shift)**2 * params[9] * np.exp(-params[10] * (wavelength - params[11])**2)\n    return efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 7, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Optimized SHG efficiency model with refined phase modulation and amplitude scaling\n    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)\n    sinc_term = np.sinc(normalized_wavelength)**2  # Squaring the sinc term for enhanced interference effect\n    phase_shift = 2 * np.pi * (params[2] * width + params[3] * wavelength) + params[4] * np.sin(params[5] * wavelength)\n    envelope_term = np.exp(-params[6] * (width - params[7])**2) * np.cos(2 * np.pi * params[8] * wavelength)**2  # Double the cosine term for stronger modulation\n    efficiency = sinc_term * np.cos(phase_shift)**2 * params[9] * np.exp(-params[10] * (wavelength - params[11])**2)\n    return efficiency')
Error during mutation/evaluation for island 0x7f205b8f27b0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Normalize the width based on a parameter\n    normalized_width = width / params[0]\n    # Calculate the phase mismatch term using another parameter\n    phase_mismatch = params[1] * (wavelength - params[2])\n    # Compute the sinc function adjusted by the phase mismatch and a damping factor, including a physical correction factor\n    sinc_term = np.sinc(normalized_width + phase_mismatch) * np.exp(-((wavelength - params[3]) / params[4]) ** 2)\n    # Calculate SHG efficiency, incorporating an additional factor for physical accuracy and accounting for the nonlinear refractive index effect\n    non_linear_effect = np.tanh(params[5] * (wavelength - params[6]))\n    # Introduce a Gaussian correction to account for spatial coherence effects\n    gaussian_coherence = np.exp(-((width - params[9]) ** 2) / (2 * params[10] ** 2))\n    efficiency = ((sinc_term ** 2) / ((wavelength - params[7]) ** 2 + params[8] ** 2)) * non_linear_effect * gaussian_coherence\n    return efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 11, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Normalize the width based on a parameter\n    normalized_width = width / params[0]\n    # Calculate the phase mismatch term using another parameter\n    phase_mismatch = params[1] * (wavelength - params[2])\n    # Compute the sinc function adjusted by the phase mismatch and a damping factor, including a physical correction factor\n    sinc_term = np.sinc(normalized_width + phase_mismatch) * np.exp(-((wavelength - params[3]) / params[4]) ** 2)\n    # Calculate SHG efficiency, incorporating an additional factor for physical accuracy and accounting for the nonlinear refractive index effect\n    non_linear_effect = np.tanh(params[5] * (wavelength - params[6]))\n    # Introduce a Gaussian correction to account for spatial coherence effects\n    gaussian_coherence = np.exp(-((width - params[9]) ** 2) / (2 * params[10] ** 2))\n    efficiency = ((sinc_term ** 2) / ((wavelength - params[7]) ** 2 + params[8] ** 2)) * non_linear_effect * gaussian_coherence\n    return efficiency')
Error during mutation/evaluation for island 0x7f206117b170: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the k-mismatch term which is crucial for quasi-phase matching\n    k_mismatch = (2 * np.pi / wavelength) - (2 * np.pi * params[0] / width)\n    \n    # Introduce a more complex modulation factor that accounts for higher order harmonics and their interactions\n    modulation_factor = 1 + params[1] * np.sin(2 * np.pi * params[2] * width / wavelength) + params[3] * np.cos(4 * np.pi * params[4] * width / wavelength) + params[5] * np.sin(6 * np.pi * params[6] * width / wavelength)\n    \n    # Use a more sophisticated sinc-like function to capture the efficiency better\n    sinc_term = (np.sinc(k_mismatch - params[7]) * modulation_factor)**2  # Squaring inside sinc term for emphasis on phase matching\n    \n    # Enhance Gaussian envelope with an additional exponential decay based on wavelength\n    gaussian_envelope = np.exp(-((width - params[8])**2) / (2 * (params[9]**2)) - params[10] * (wavelength - params[11])**2)\n    \n    # Calculate SHG efficiency as the product of the improved sinc term and Gaussian envelope, adjusted by parameters\n    shg_efficiency = params[12] * sinc_term * gaussian_envelope + params[13]\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 12, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the k-mismatch term which is crucial for quasi-phase matching\n    k_mismatch = (2 * np.pi / wavelength) - (2 * np.pi * params[0] / width)\n    \n    # Introduce a more complex modulation factor that accounts for higher order harmonics and their interactions\n    modulation_factor = 1 + params[1] * np.sin(2 * np.pi * params[2] * width / wavelength) + params[3] * np.cos(4 * np.pi * params[4] * width / wavelength) + params[5] * np.sin(6 * np.pi * params[6] * width / wavelength)\n    \n    # Use a more sophisticated sinc-like function to capture the efficiency better\n    sinc_term = (np.sinc(k_mismatch - params[7]) * modulation_factor)**2  # Squaring inside sinc term for emphasis on phase matching\n    \n    # Enhance Gaussian envelope with an additional exponential decay based on wavelength\n    gaussian_envelope = np.exp(-((width - params[8])**2) / (2 * (params[9]**2)) - params[10] * (wavelength - params[11])**2)\n    \n    # Calculate SHG efficiency as the product of the improved sinc term and Gaussian envelope, adjusted by parameters\n    shg_efficiency = params[12] * sinc_term * gaussian_envelope + params[13]\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f205b8f27b0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    normalized_width = width / (params[0] + params[9])\n    phase_mismatch = params[1] * (wavelength - params[2])\n    sinc_term = np.sinc(normalized_width + phase_mismatch) * np.exp(-((wavelength - params[3]) / (params[4] + params[10])) ** 2)\n    non_linear_effect = np.tanh(params[5] * (wavelength - params[6]))\n    damping_factor = np.exp(-((wavelength - params[7]) ** 2) / (2 * (params[8] + params[11]) ** 2))\n    efficiency = ((sinc_term ** 2) * damping_factor * non_linear_effect) / ((wavelength - params[12]) ** 2 + params[13] ** 2)\n    return efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 4, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    normalized_width = width / (params[0] + params[9])\n    phase_mismatch = params[1] * (wavelength - params[2])\n    sinc_term = np.sinc(normalized_width + phase_mismatch) * np.exp(-((wavelength - params[3]) / (params[4] + params[10])) ** 2)\n    non_linear_effect = np.tanh(params[5] * (wavelength - params[6]))\n    damping_factor = np.exp(-((wavelength - params[7]) ** 2) / (2 * (params[8] + params[11]) ** 2))\n    efficiency = ((sinc_term ** 2) * damping_factor * non_linear_effect) / ((wavelength - params[12]) ** 2 + params[13] ** 2)\n    return efficiency')
Error during mutation/evaluation for island 0x7f205b6df1a0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    num_domains = int(params[0])\n    domain_period = width / num_domains\n    normalized_wavelength = wavelength / (domain_period * params[1])\n    phase_shift = params[4]\n    damping_factor = params[5]\n    frequency_modulation = params[6]  # Introducing a frequency modulation term for more flexibility\n    amplitude_variation = params[7]  # Amplitude variation with wavelength to account for phase mismatch effects\n    temporal_delay = params[8]  # Temporal delay effect in the SHG process\n    chirp_effect = params[9]  # Chirp effect to model changes in frequency over distance\n    \n    # Introducing a Gaussian envelope to better capture the localized nature of the interaction\n    gaussian_envelope = np.exp(-0.5 * ((normalized_wavelength - phase_shift) / params[10])**2)\n    \n    modulated_sinc_term = np.sinc(normalized_wavelength + phase_shift + frequency_modulation * wavelength) * gaussian_envelope\n    damped_modulated_sinc_term = modulated_sinc_term * np.exp(-damping_factor * (wavelength - temporal_delay)**2)\n    amplitude = params[2] + amplitude_variation * wavelength**chirp_effect\n    offset = params[3]\n    efficiency = amplitude * np.power(damped_modulated_sinc_term, 2) + offset\n    return efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 13, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    num_domains = int(params[0])\n    domain_period = width / num_domains\n    normalized_wavelength = wavelength / (domain_period * params[1])\n    phase_shift = params[4]\n    damping_factor = params[5]\n    frequency_modulation = params[6]  # Introducing a frequency modulation term for more flexibility\n    amplitude_variation = params[7]  # Amplitude variation with wavelength to account for phase mismatch effects\n    temporal_delay = params[8]  # Temporal delay effect in the SHG process\n    chirp_effect = params[9]  # Chirp effect to model changes in frequency over distance\n    \n    # Introducing a Gaussian envelope to better capture the localized nature of the interaction\n    gaussian_envelope = np.exp(-0.5 * ((normalized_wavelength - phase_shift) / params[10])**2)\n    \n    modulated_sinc_term = np.sinc(normalized_wavelength + phase_shift + frequency_modulation * wavelength) * gaussian_envelope\n    damped_modulated_sinc_term = modulated_sinc_term * np.exp(-damping_factor * (wavelength - temporal_delay)**2)\n    amplitude = params[2] + amplitude_variation * wavelength**chirp_effect\n    offset = params[3]\n    efficiency = amplitude * np.power(damped_modulated_sinc_term, 2) + offset\n    return efficiency')
/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py:1173: LineSearchWarning: The line search algorithm did not converge
  ret = line_search_wolfe2(f, fprime, xk, pk, gfk,
Error during mutation/evaluation for island 0x7f205b6df1a0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    num_domains = int(params[0])\n    domain_period = width / num_domains\n    normalized_wavelength = wavelength / (domain_period * params[1])\n    phase_shift = params[4]\n    damping_factor = params[5]\n    frequency_modulation = params[6]  # Introducing a frequency modulation term for more flexibility\n    amplitude_variation = params[7]  # Amplitude variation with wavelength to account for phase mismatch effects\n    temporal_delay = params[8]  # Temporal delay effect in the SHG process\n    chirp_effect = params[9]  # Chirp effect to model changes in frequency over distance\n    # Modulated sinc term considering phase shift, frequency modulation, and a more complex phase relationship\n    modulated_sinc_term = np.sinc(normalized_wavelength + phase_shift * np.sin(2 * np.pi * normalized_wavelength) + frequency_modulation * wavelength)\n    # Quadratic damping with temporal delay\n    damped_modulated_sinc_term = modulated_sinc_term * np.exp(-damping_factor * (wavelength - temporal_delay)**2)\n    # Amplitude that varies with wavelength and includes a chirp effect, potentially modeling non-linear interactions\n    amplitude = params[2] + amplitude_variation * wavelength**chirp_effect * np.cos(2 * np.pi * normalized_wavelength)  # Added cosine modulation to capture more complex physical behaviors\n    # Offset term for the efficiency calculation\n    offset = params[3]\n    # Calculating SHG efficiency as the square of the damped modulated sinc term scaled by amplitude and added to an offset, with a possible correction factor for better fit\n    efficiency = (amplitude * np.power(damped_modulated_sinc_term, 2) + offset) * params[10]  # Multiplying by a global scaling factor to fine-tune the overall magnitude of efficiency\n    return efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 20, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    num_domains = int(params[0])\n    domain_period = width / num_domains\n    normalized_wavelength = wavelength / (domain_period * params[1])\n    phase_shift = params[4]\n    damping_factor = params[5]\n    frequency_modulation = params[6]  # Introducing a frequency modulation term for more flexibility\n    amplitude_variation = params[7]  # Amplitude variation with wavelength to account for phase mismatch effects\n    temporal_delay = params[8]  # Temporal delay effect in the SHG process\n    chirp_effect = params[9]  # Chirp effect to model changes in frequency over distance\n    # Modulated sinc term considering phase shift, frequency modulation, and a more complex phase relationship\n    modulated_sinc_term = np.sinc(normalized_wavelength + phase_shift * np.sin(2 * np.pi * normalized_wavelength) + frequency_modulation * wavelength)\n    # Quadratic damping with temporal delay\n    damped_modulated_sinc_term = modulated_sinc_term * np.exp(-damping_factor * (wavelength - temporal_delay)**2)\n    # Amplitude that varies with wavelength and includes a chirp effect, potentially modeling non-linear interactions\n    amplitude = params[2] + amplitude_variation * wavelength**chirp_effect * np.cos(2 * np.pi * normalized_wavelength)  # Added cosine modulation to capture more complex physical behaviors\n    # Offset term for the efficiency calculation\n    offset = params[3]\n    # Calculating SHG efficiency as the square of the damped modulated sinc term scaled by amplitude and added to an offset, with a possible correction factor for better fit\n    efficiency = (amplitude * np.power(damped_modulated_sinc_term, 2) + offset) * params[10]  # Multiplying by a global scaling factor to fine-tune the overall magnitude of efficiency\n    return efficiency')
Error during mutation/evaluation for island 0x7f205b3528a0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)\n    sinc_term = np.sinc(normalized_wavelength)**2\n    phase_shift = 2 * np.pi * (params[2] * width + params[3] * wavelength) + params[4] * np.sin(params[5] * wavelength)\n    envelope_term = np.exp(-params[6] * (width - params[7])**2) * np.cos(2 * np.pi * params[8] * wavelength)**2\n    efficiency = sinc_term * np.cos(phase_shift + params[9])**2 * np.exp(params[10])\n    return efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 6, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)\n    sinc_term = np.sinc(normalized_wavelength)**2\n    phase_shift = 2 * np.pi * (params[2] * width + params[3] * wavelength) + params[4] * np.sin(params[5] * wavelength)\n    envelope_term = np.exp(-params[6] * (width - params[7])**2) * np.cos(2 * np.pi * params[8] * wavelength)**2\n    efficiency = sinc_term * np.cos(phase_shift + params[9])**2 * np.exp(params[10])\n    return efficiency')
Error during mutation/evaluation for island 0x7f20597a7590: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    nonlinear_effect = params[3] * sinc_component**2\n    exp_decay = np.exp(-width**2 / (2 * params[4]**2))\n    coherence_term = np.cos(2 * np.pi / params[5] * width)**2\n    shg_efficiency = nonlinear_effect * exp_decay * coherence_term + params[6] * wavelength**(-params[7]) + params[8] * k_mismatch**2 + params[9] * width**(-params[10])\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 9, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    nonlinear_effect = params[3] * sinc_component**2\n    exp_decay = np.exp(-width**2 / (2 * params[4]**2))\n    coherence_term = np.cos(2 * np.pi / params[5] * width)**2\n    shg_efficiency = nonlinear_effect * exp_decay * coherence_term + params[6] * wavelength**(-params[7]) + params[8] * k_mismatch**2 + params[9] * width**(-params[10])\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f205b3528a0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)\n    sinc_term = np.sinc(normalized_wavelength)**2\n    phase_shift = 2 * np.pi * (params[2] * width + params[3] * wavelength) + params[4] * np.sin(params[5] * wavelength)\n    envelope_term = np.exp(-params[6] * (width - params[7])**2) * np.cos(2 * np.pi * params[8] * wavelength)**2\n    efficiency = sinc_term * np.cos(phase_shift + params[9])**2 * params[10]\n    return efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 6, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)\n    sinc_term = np.sinc(normalized_wavelength)**2\n    phase_shift = 2 * np.pi * (params[2] * width + params[3] * wavelength) + params[4] * np.sin(params[5] * wavelength)\n    envelope_term = np.exp(-params[6] * (width - params[7])**2) * np.cos(2 * np.pi * params[8] * wavelength)**2\n    efficiency = sinc_term * np.cos(phase_shift + params[9])**2 * params[10]\n    return efficiency')
Error during mutation/evaluation for island 0x7f205b3216d0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate fundamental frequency mismatch\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    \n    # Sinc-like function component with phase shift and broadening factor\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    \n    # Spatial inhomogeneities and propagation effects with Gaussian decay\n    gaussian_decay = np.exp(-width**2 / (2 * params[3]**2))\n    \n    # Stimulated Raman scattering effect, assuming a quadratic relationship with wavelength\n    srs_effect = params[4] * (np.cos(params[5] * wavelength)**2)\n    \n    # Correction for stimulated Brillouin scattering (SBS) proportional to the cube of k_mismatch\n    sbs_correction = params[6] * k_mismatch**3\n    \n    # Higher-order nonlinear effects correction term\n    higher_order_correction = params[7] * k_mismatch**2\n    \n    # Calculate SHG efficiency with comprehensive physical considerations\n    shg_efficiency = params[8] * sinc_component**2 * gaussian_decay + srs_effect + sbs_correction - higher_order_correction + params[9] * width**(-params[10])\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 23, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate fundamental frequency mismatch\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    \n    # Sinc-like function component with phase shift and broadening factor\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    \n    # Spatial inhomogeneities and propagation effects with Gaussian decay\n    gaussian_decay = np.exp(-width**2 / (2 * params[3]**2))\n    \n    # Stimulated Raman scattering effect, assuming a quadratic relationship with wavelength\n    srs_effect = params[4] * (np.cos(params[5] * wavelength)**2)\n    \n    # Correction for stimulated Brillouin scattering (SBS) proportional to the cube of k_mismatch\n    sbs_correction = params[6] * k_mismatch**3\n    \n    # Higher-order nonlinear effects correction term\n    higher_order_correction = params[7] * k_mismatch**2\n    \n    # Calculate SHG efficiency with comprehensive physical considerations\n    shg_efficiency = params[8] * sinc_component**2 * gaussian_decay + srs_effect + sbs_correction - higher_order_correction + params[9] * width**(-params[10])\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f205b866600: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    phase_modulation = params[0] * np.sin(params[1] * width / wavelength)\n    amplitude_envelope = params[2] * np.exp(-((width - params[3]) ** 2) / (2 * params[4] ** 2))\n    frequency_shift = params[5] * np.cos(params[6] * width / wavelength)\n    combined_term = phase_modulation + amplitude_envelope + frequency_shift\n    sinc_argument = combined_term / (params[7] * wavelength)\n    # Introducing a correction factor to better match the physical behavior\n    correction_factor = params[8]\n    sinc_term = np.sinc(sinc_argument) * correction_factor\n    efficiency = params[9] * (sinc_term ** 2) + params[10]\n    return efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 10, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    phase_modulation = params[0] * np.sin(params[1] * width / wavelength)\n    amplitude_envelope = params[2] * np.exp(-((width - params[3]) ** 2) / (2 * params[4] ** 2))\n    frequency_shift = params[5] * np.cos(params[6] * width / wavelength)\n    combined_term = phase_modulation + amplitude_envelope + frequency_shift\n    sinc_argument = combined_term / (params[7] * wavelength)\n    # Introducing a correction factor to better match the physical behavior\n    correction_factor = params[8]\n    sinc_term = np.sinc(sinc_argument) * correction_factor\n    efficiency = params[9] * (sinc_term ** 2) + params[10]\n    return efficiency')
Error during mutation/evaluation for island 0x7f205b6df1a0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    num_domains = int(params[0])\n    domain_period = width / num_domains\n    normalized_wavelength = wavelength / (domain_period * params[1])\n    phase_shift = params[4]\n    damping_factor = params[5]\n    frequency_modulation = params[6]  # Introducing a frequency modulation term for more flexibility\n    amplitude_variation = params[7]  # Amplitude variation with wavelength to account for phase mismatch effects\n    temporal_delay = params[8]  # Temporal delay effect in the SHG process\n    chirp_effect = params[9]  # Chirp effect to model changes in frequency over distance\n    # Modulated sinc term considering phase shift and frequency modulation\n    modulated_sinc_term = np.sinc(normalized_wavelength + phase_shift + frequency_modulation * wavelength)\n    # Quadratic damping with temporal delay\n    damped_modulated_sinc_term = modulated_sinc_term * np.exp(-damping_factor * (wavelength - temporal_delay)**2)\n    # Amplitude that varies with wavelength and includes a chirp effect\n    amplitude = params[2] + amplitude_variation * wavelength**chirp_effect\n    # Offset term for the efficiency calculation\n    offset = params[3]\n    # Additional factor to consider phase matching accuracy, inversely proportional to domain width\n    phase_matching_accuracy = 1 / (domain_period * params[10])\n    # Including a temperature effect on efficiency, based on a simple linear model\n    temperature_effect = params[11] * (params[12] - wavelength)  # Assuming params[12] is the reference wavelength at which SHG is most efficient\n    # Final efficiency calculation incorporating all factors\n    efficiency = amplitude * np.power(damped_modulated_sinc_term, 2) * phase_matching_accuracy + offset + temperature_effect\n    return efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 20, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    num_domains = int(params[0])\n    domain_period = width / num_domains\n    normalized_wavelength = wavelength / (domain_period * params[1])\n    phase_shift = params[4]\n    damping_factor = params[5]\n    frequency_modulation = params[6]  # Introducing a frequency modulation term for more flexibility\n    amplitude_variation = params[7]  # Amplitude variation with wavelength to account for phase mismatch effects\n    temporal_delay = params[8]  # Temporal delay effect in the SHG process\n    chirp_effect = params[9]  # Chirp effect to model changes in frequency over distance\n    # Modulated sinc term considering phase shift and frequency modulation\n    modulated_sinc_term = np.sinc(normalized_wavelength + phase_shift + frequency_modulation * wavelength)\n    # Quadratic damping with temporal delay\n    damped_modulated_sinc_term = modulated_sinc_term * np.exp(-damping_factor * (wavelength - temporal_delay)**2)\n    # Amplitude that varies with wavelength and includes a chirp effect\n    amplitude = params[2] + amplitude_variation * wavelength**chirp_effect\n    # Offset term for the efficiency calculation\n    offset = params[3]\n    # Additional factor to consider phase matching accuracy, inversely proportional to domain width\n    phase_matching_accuracy = 1 / (domain_period * params[10])\n    # Including a temperature effect on efficiency, based on a simple linear model\n    temperature_effect = params[11] * (params[12] - wavelength)  # Assuming params[12] is the reference wavelength at which SHG is most efficient\n    # Final efficiency calculation incorporating all factors\n    efficiency = amplitude * np.power(damped_modulated_sinc_term, 2) * phase_matching_accuracy + offset + temperature_effect\n    return efficiency')
<ast>:7: RuntimeWarning: overflow encountered in power
<ast>:7: RuntimeWarning: invalid value encountered in multiply
<ast>:7: RuntimeWarning: overflow encountered in power
<ast>:7: RuntimeWarning: invalid value encountered in multiply
<ast>:7: RuntimeWarning: overflow encountered in power
<ast>:7: RuntimeWarning: invalid value encountered in multiply
Error during mutation/evaluation for island 0x7f205b3216d0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    gaussian_decay = np.exp(-width**2 / (2 * params[3]**2))\n    stimulated_raman_effect = params[4] * (np.cos(params[5] * wavelength)**2)\n    higher_order_nonlinearity = params[6] * k_mismatch**params[7]\n\n    # Combine all components to form the SHG efficiency equation\n    shg_efficiency = ( params[8] * sinc_component**2 * gaussian_decay + stimulated_raman_effect + higher_order_nonlinearity - params[9] * wavelength**(-params[10])\n    )\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 11, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    gaussian_decay = np.exp(-width**2 / (2 * params[3]**2))\n    stimulated_raman_effect = params[4] * (np.cos(params[5] * wavelength)**2)\n    higher_order_nonlinearity = params[6] * k_mismatch**params[7]\n\n    # Combine all components to form the SHG efficiency equation\n    shg_efficiency = ( params[8] * sinc_component**2 * gaussian_decay + stimulated_raman_effect + higher_order_nonlinearity - params[9] * wavelength**(-params[10])\n    )\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f205b103d40: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f205b103d40: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f20597a6690: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the fundamental frequency mismatch parameter\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    # Define the sinc-like function component with phase shift and broadening consideration\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    \n    # Calculate nonlinear interaction effects more accurately by considering quadratic terms\n    nonlinear_effect = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2))\n    \n    # Adding higher-order interaction terms based on experimental data and refined physical understanding\n    higher_order_term_1 = params[5] * wavelength**(-params[6])\n    higher_order_term_2 = params[7] * width**(-params[8])\n    higher_order_term_3 = params[9] * k_mismatch**2\n    \n    # Incorporating a correction factor for domain width to better reflect physical constraints\n    width_correction_factor = np.exp(-width / (2 * params[10]))\n    \n    # Combining all terms to get the final SHG efficiency with enhanced accuracy and physical relevance\n    shg_efficiency = nonlinear_effect + higher_order_term_1 + higher_order_term_2 + higher_order_term_3 + width_correction_factor\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 18, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the fundamental frequency mismatch parameter\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    # Define the sinc-like function component with phase shift and broadening consideration\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    \n    # Calculate nonlinear interaction effects more accurately by considering quadratic terms\n    nonlinear_effect = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2))\n    \n    # Adding higher-order interaction terms based on experimental data and refined physical understanding\n    higher_order_term_1 = params[5] * wavelength**(-params[6])\n    higher_order_term_2 = params[7] * width**(-params[8])\n    higher_order_term_3 = params[9] * k_mismatch**2\n    \n    # Incorporating a correction factor for domain width to better reflect physical constraints\n    width_correction_factor = np.exp(-width / (2 * params[10]))\n    \n    # Combining all terms to get the final SHG efficiency with enhanced accuracy and physical relevance\n    shg_efficiency = nonlinear_effect + higher_order_term_1 + higher_order_term_2 + higher_order_term_3 + width_correction_factor\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f205b103d40: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f205b3216d0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the fundamental frequency mismatch parameter\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    # Define the sinc-like function component with phase shift and broadening consideration\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    # Introduce a term to account for stimulated Raman scattering (SRS) effect which is proportional to the square of the pump intensity\n    srs_effect = params[3] * (np.cos(params[5] * wavelength)**2)\n    # Include a Gaussian decay factor to account for spatial inhomogeneities and propagation effects\n    gaussian_decay = np.exp(-width**2 / (2 * params[4]**2))\n    # Higher-order nonlinear effects correction, now using a more complex polynomial term\n    higher_order_correction = params[6] * k_mismatch**4 + params[7] * k_mismatch**3 + params[8] * k_mismatch**2\n    # Calculate the SHG efficiency with improved physical accuracy considering nonlinear and SRS effects\n    shg_efficiency = params[9] * sinc_component**2 * gaussian_decay + srs_effect + higher_order_correction - params[10] * wavelength**(-params[11])\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 15, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the fundamental frequency mismatch parameter\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    # Define the sinc-like function component with phase shift and broadening consideration\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    # Introduce a term to account for stimulated Raman scattering (SRS) effect which is proportional to the square of the pump intensity\n    srs_effect = params[3] * (np.cos(params[5] * wavelength)**2)\n    # Include a Gaussian decay factor to account for spatial inhomogeneities and propagation effects\n    gaussian_decay = np.exp(-width**2 / (2 * params[4]**2))\n    # Higher-order nonlinear effects correction, now using a more complex polynomial term\n    higher_order_correction = params[6] * k_mismatch**4 + params[7] * k_mismatch**3 + params[8] * k_mismatch**2\n    # Calculate the SHG efficiency with improved physical accuracy considering nonlinear and SRS effects\n    shg_efficiency = params[9] * sinc_component**2 * gaussian_decay + srs_effect + higher_order_correction - params[10] * wavelength**(-params[11])\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f205b103d40: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f205b3528a0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)\n    sinc_term = np.sinc(normalized_wavelength)**2\n    phase_shift = 2 * np.pi * (params[2] * width + params[3] * wavelength) + params[4] * np.sin(params[5] * wavelength)\n    envelope_term = np.exp(-params[6] * (width - params[7])**2) * np.cos(2 * np.pi * params[8] * wavelength)**2\n    efficiency = sinc_term * np.cos(phase_shift + params[9])**2 * np.exp(params[10])\n    return efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 6, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)\n    sinc_term = np.sinc(normalized_wavelength)**2\n    phase_shift = 2 * np.pi * (params[2] * width + params[3] * wavelength) + params[4] * np.sin(params[5] * wavelength)\n    envelope_term = np.exp(-params[6] * (width - params[7])**2) * np.cos(2 * np.pi * params[8] * wavelength)**2\n    efficiency = sinc_term * np.cos(phase_shift + params[9])**2 * np.exp(params[10])\n    return efficiency')
Error during mutation/evaluation for island 0x7f205b103d40: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
<ast>:5: RuntimeWarning: overflow encountered in exp
<ast>:6: RuntimeWarning: invalid value encountered in multiply
<ast>:6: RuntimeWarning: invalid value encountered in multiply
<ast>:5: RuntimeWarning: overflow encountered in exp
<ast>:6: RuntimeWarning: invalid value encountered in multiply
<ast>:5: RuntimeWarning: overflow encountered in exp
<ast>:5: RuntimeWarning: overflow encountered in exp
<ast>:6: RuntimeWarning: invalid value encountered in multiply
<ast>:5: RuntimeWarning: overflow encountered in exp
<ast>:6: RuntimeWarning: invalid value encountered in multiply
<ast>:5: RuntimeWarning: overflow encountered in exp
<ast>:6: RuntimeWarning: invalid value encountered in multiply
<ast>:5: RuntimeWarning: overflow encountered in exp
<ast>:6: RuntimeWarning: invalid value encountered in multiply
Error during mutation/evaluation for island 0x7f205b866600: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Phase modulation term considering both sine and cosine components\n    phase_modulation = (params[0] * np.sin(params[1] * width / wavelength) + params[2] * np.cos(params[3] * width / wavelength))\n    \n    # Amplitude envelope term using a Gaussian function to model the intensity distribution\n    amplitude_envelope = params[4] * np.exp(-((width - params[5]) ** 2) / (2 * params[6] ** 2))\n    \n    # Frequency shift term considering both sine and cosine components for more complex phase modulation\n    frequency_shift = (params[7] * np.sin(params[8] * width / wavelength) + params[9] * np.cos(params[10] * width / wavelength))\n    \n    # Combined term that integrates all the above components to model the quasi-phase matching effect\n    combined_term = phase_modulation + amplitude_envelope + frequency_shift\n    \n    # Sinc argument scaled by wavelength and a phase shift parameter for better alignment with experimental data\n    sinc_argument = (combined_term / (params[11] * wavelength)) - params[12]\n    \n    # Calculate the sinc function of the combined term, which is crucial for SHG efficiency\n    sinc_term = np.sinc(sinc_argument)\n    \n    # Final efficiency calculation with an additional scaling factor and offset to fit experimental data\n    efficiency = (params[13] * (sinc_term ** 2) + params[14])\n    return efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 9, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Phase modulation term considering both sine and cosine components\n    phase_modulation = (params[0] * np.sin(params[1] * width / wavelength) + params[2] * np.cos(params[3] * width / wavelength))\n    \n    # Amplitude envelope term using a Gaussian function to model the intensity distribution\n    amplitude_envelope = params[4] * np.exp(-((width - params[5]) ** 2) / (2 * params[6] ** 2))\n    \n    # Frequency shift term considering both sine and cosine components for more complex phase modulation\n    frequency_shift = (params[7] * np.sin(params[8] * width / wavelength) + params[9] * np.cos(params[10] * width / wavelength))\n    \n    # Combined term that integrates all the above components to model the quasi-phase matching effect\n    combined_term = phase_modulation + amplitude_envelope + frequency_shift\n    \n    # Sinc argument scaled by wavelength and a phase shift parameter for better alignment with experimental data\n    sinc_argument = (combined_term / (params[11] * wavelength)) - params[12]\n    \n    # Calculate the sinc function of the combined term, which is crucial for SHG efficiency\n    sinc_term = np.sinc(sinc_argument)\n    \n    # Final efficiency calculation with an additional scaling factor and offset to fit experimental data\n    efficiency = (params[13] * (sinc_term ** 2) + params[14])\n    return efficiency')
Error during mutation/evaluation for island 0x7f205b103d40: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f205b3528a0: Non-finite scores detected. Problematic clusters -> [index 10: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)
    sinc_term = np.sinc(normalized_wavelength)**2
    phase_shift = 2 * np.pi * (params[2] * width + params[3] * wavelength) + params[4] * np.sin(params[5] * wavelength)
    envelope_term = np.exp(-params[6] * (width - params[7])**2) * np.cos(2 * np.pi * params[8] * wavelength)**2
    efficiency = sinc_term * np.exp(-1j * phase_shift)**2 * envelope_term * params[9]
    return np.abs(efficiency)**2']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 10: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)
    sinc_term = np.sinc(normalized_wavelength)**2
    phase_shift = 2 * np.pi * (params[2] * width + params[3] * wavelength) + params[4] * np.sin(params[5] * wavelength)
    envelope_term = np.exp(-params[6] * (width - params[7])**2) * np.cos(2 * np.pi * params[8] * wavelength)**2
    efficiency = sinc_term * np.exp(-1j * phase_shift)**2 * envelope_term * params[9]
    return np.abs(efficiency)**2']
Error during mutation/evaluation for island 0x7f205b103d40: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f205b3528a0: Non-finite scores detected. Problematic clusters -> [index 10: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)
    sinc_term = np.sinc(normalized_wavelength)**2
    phase_shift = 2 * np.pi * (params[2] * width + params[3] * wavelength) + params[4] * np.sin(params[5] * wavelength)
    envelope_term = np.exp(-params[6] * (width - params[7])**2) * np.cos(2 * np.pi * params[8] * wavelength)**2
    efficiency = sinc_term * np.exp(-1j * phase_shift)**2 * envelope_term * params[9]
    return np.abs(efficiency)**2']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 10: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)
    sinc_term = np.sinc(normalized_wavelength)**2
    phase_shift = 2 * np.pi * (params[2] * width + params[3] * wavelength) + params[4] * np.sin(params[5] * wavelength)
    envelope_term = np.exp(-params[6] * (width - params[7])**2) * np.cos(2 * np.pi * params[8] * wavelength)**2
    efficiency = sinc_term * np.exp(-1j * phase_shift)**2 * envelope_term * params[9]
    return np.abs(efficiency)**2']
Error during mutation/evaluation for island 0x7f205b103d40: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f205b3528a0: Non-finite scores detected. Problematic clusters -> [index 10: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)
    sinc_term = np.sinc(normalized_wavelength)**2
    phase_shift = 2 * np.pi * (params[2] * width + params[3] * wavelength) + params[4] * np.sin(params[5] * wavelength)
    envelope_term = np.exp(-params[6] * (width - params[7])**2) * np.cos(2 * np.pi * params[8] * wavelength)**2
    efficiency = sinc_term * np.exp(-1j * phase_shift)**2 * envelope_term * params[9]
    return np.abs(efficiency)**2']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 10: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)
    sinc_term = np.sinc(normalized_wavelength)**2
    phase_shift = 2 * np.pi * (params[2] * width + params[3] * wavelength) + params[4] * np.sin(params[5] * wavelength)
    envelope_term = np.exp(-params[6] * (width - params[7])**2) * np.cos(2 * np.pi * params[8] * wavelength)**2
    efficiency = sinc_term * np.exp(-1j * phase_shift)**2 * envelope_term * params[9]
    return np.abs(efficiency)**2']
Error during mutation/evaluation for island 0x7f205b103d40: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f205b3528a0: Non-finite scores detected. Problematic clusters -> [index 10: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)
    sinc_term = np.sinc(normalized_wavelength)**2
    phase_shift = 2 * np.pi * (params[2] * width + params[3] * wavelength) + params[4] * np.sin(params[5] * wavelength)
    envelope_term = np.exp(-params[6] * (width - params[7])**2) * np.cos(2 * np.pi * params[8] * wavelength)**2
    efficiency = sinc_term * np.exp(-1j * phase_shift)**2 * envelope_term * params[9]
    return np.abs(efficiency)**2']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 10: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)
    sinc_term = np.sinc(normalized_wavelength)**2
    phase_shift = 2 * np.pi * (params[2] * width + params[3] * wavelength) + params[4] * np.sin(params[5] * wavelength)
    envelope_term = np.exp(-params[6] * (width - params[7])**2) * np.cos(2 * np.pi * params[8] * wavelength)**2
    efficiency = sinc_term * np.exp(-1j * phase_shift)**2 * envelope_term * params[9]
    return np.abs(efficiency)**2']
Error during mutation/evaluation for island 0x7f20597a6690: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the fundamental frequency mismatch parameter\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    # Define the sinc-like function component with phase shift and broadening consideration\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    # Introduce a quadratic term to account for nonlinear effects and higher-order interactions in SHG\n    non_linear_term = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2))\n    # Modify the wavelength dependency to reflect more accurate physical behavior, e.g., using a different power or function\n    wavelength_effect = params[5] * np.log(wavelength) + params[6] * wavelength**(-params[7])\n    # Adjust width dependency considering potential anharmonicity in domain structure\n    width_effect = params[8] * width**(-params[9]) + params[10] * (width - params[11])**2\n    # Combine all effects to calculate SHG efficiency\n    shg_efficiency = non_linear_term + wavelength_effect + width_effect + params[12] * k_mismatch**2\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 13, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the fundamental frequency mismatch parameter\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    # Define the sinc-like function component with phase shift and broadening consideration\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    # Introduce a quadratic term to account for nonlinear effects and higher-order interactions in SHG\n    non_linear_term = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2))\n    # Modify the wavelength dependency to reflect more accurate physical behavior, e.g., using a different power or function\n    wavelength_effect = params[5] * np.log(wavelength) + params[6] * wavelength**(-params[7])\n    # Adjust width dependency considering potential anharmonicity in domain structure\n    width_effect = params[8] * width**(-params[9]) + params[10] * (width - params[11])**2\n    # Combine all effects to calculate SHG efficiency\n    shg_efficiency = non_linear_term + wavelength_effect + width_effect + params[12] * k_mismatch**2\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f205b103d40: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f205b3528a0: Non-finite scores detected. Problematic clusters -> [index 10: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)
    sinc_term = np.sinc(normalized_wavelength)**2
    phase_shift = 2 * np.pi * (params[2] * width + params[3] * wavelength) + params[4] * np.sin(params[5] * wavelength)
    envelope_term = np.exp(-params[6] * (width - params[7])**2) * np.cos(2 * np.pi * params[8] * wavelength)**2
    efficiency = sinc_term * np.exp(-1j * phase_shift)**2 * envelope_term * params[9]
    return np.abs(efficiency)**2']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 10: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)
    sinc_term = np.sinc(normalized_wavelength)**2
    phase_shift = 2 * np.pi * (params[2] * width + params[3] * wavelength) + params[4] * np.sin(params[5] * wavelength)
    envelope_term = np.exp(-params[6] * (width - params[7])**2) * np.cos(2 * np.pi * params[8] * wavelength)**2
    efficiency = sinc_term * np.exp(-1j * phase_shift)**2 * envelope_term * params[9]
    return np.abs(efficiency)**2']
Error during mutation/evaluation for island 0x7f205b6df1a0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    num_domains = int(params[0])\n    domain_period = width / num_domains\n    normalized_wavelength = wavelength / (domain_period * params[1])\n    phase_shift = params[4]\n    damping_factor = params[5]\n    frequency_modulation = params[6]\n    amplitude_variation = params[7]\n    temporal_delay = params[8]\n    chirp_effect = params[9]\n    \n    # Improved term for modulating sinc function with chirp effect\n    transformed_wavelength = normalized_wavelength + phase_shift + frequency_modulation * wavelength + amplitude_variation * np.sin(wavelength - temporal_delay) + chirp_effect * (wavelength - domain_period)**2\n    modulated_sinc_term = np.sinc(transformed_wavelength)\n    \n    # Quadratic damping effect with a temporal delay and improved modulation\n    damped_modulated_sinc_term = modulated_sinc_term * np.exp(-damping_factor * (wavelength - temporal_delay - params[10])**2)  # Additional parameter for dynamic phase adjustment\n    \n    # Amplitude model including non-linear chirp effect and variation with wavelength\n    amplitude = params[2] + amplitude_variation * np.sin(wavelength**chirp_effect)  # Sinusoidal modulation for amplitude variation\n    offset = params[3]\n    \n    efficiency = amplitude * np.power(damped_modulated_sinc_term, 2) + offset\n    return efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 17, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    num_domains = int(params[0])\n    domain_period = width / num_domains\n    normalized_wavelength = wavelength / (domain_period * params[1])\n    phase_shift = params[4]\n    damping_factor = params[5]\n    frequency_modulation = params[6]\n    amplitude_variation = params[7]\n    temporal_delay = params[8]\n    chirp_effect = params[9]\n    \n    # Improved term for modulating sinc function with chirp effect\n    transformed_wavelength = normalized_wavelength + phase_shift + frequency_modulation * wavelength + amplitude_variation * np.sin(wavelength - temporal_delay) + chirp_effect * (wavelength - domain_period)**2\n    modulated_sinc_term = np.sinc(transformed_wavelength)\n    \n    # Quadratic damping effect with a temporal delay and improved modulation\n    damped_modulated_sinc_term = modulated_sinc_term * np.exp(-damping_factor * (wavelength - temporal_delay - params[10])**2)  # Additional parameter for dynamic phase adjustment\n    \n    # Amplitude model including non-linear chirp effect and variation with wavelength\n    amplitude = params[2] + amplitude_variation * np.sin(wavelength**chirp_effect)  # Sinusoidal modulation for amplitude variation\n    offset = params[3]\n    \n    efficiency = amplitude * np.power(damped_modulated_sinc_term, 2) + offset\n    return efficiency')
Error during mutation/evaluation for island 0x7f205b103d40: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f205b3528a0: Non-finite scores detected. Problematic clusters -> [index 10: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)
    sinc_term = np.sinc(normalized_wavelength)**2
    phase_shift = 2 * np.pi * (params[2] * width + params[3] * wavelength) + params[4] * np.sin(params[5] * wavelength)
    envelope_term = np.exp(-params[6] * (width - params[7])**2) * np.cos(2 * np.pi * params[8] * wavelength)**2
    efficiency = sinc_term * np.exp(-1j * phase_shift)**2 * envelope_term * params[9]
    return np.abs(efficiency)**2']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 10: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)
    sinc_term = np.sinc(normalized_wavelength)**2
    phase_shift = 2 * np.pi * (params[2] * width + params[3] * wavelength) + params[4] * np.sin(params[5] * wavelength)
    envelope_term = np.exp(-params[6] * (width - params[7])**2) * np.cos(2 * np.pi * params[8] * wavelength)**2
    efficiency = sinc_term * np.exp(-1j * phase_shift)**2 * envelope_term * params[9]
    return np.abs(efficiency)**2']
Error during mutation/evaluation for island 0x7f205b0b9d00: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    # Enhance the model by including a correction term for non-idealities in QPM\n    qpm_correction_term = params[10] * np.sin(params[11] * k_mismatch)\n    # Update SHG efficiency formula to better reflect physical behavior\n    shg_efficiency = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2)) + qpm_correction_term + params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8]) + params[9] * k_mismatch**2\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 7, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    # Enhance the model by including a correction term for non-idealities in QPM\n    qpm_correction_term = params[10] * np.sin(params[11] * k_mismatch)\n    # Update SHG efficiency formula to better reflect physical behavior\n    shg_efficiency = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2)) + qpm_correction_term + params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8]) + params[9] * k_mismatch**2\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f205b103d40: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f205b866600: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Enhance phase modulation with a quadratic term to capture non-linear effects\n    phase_modulation = params[0] * np.sin(params[1] * width / wavelength + params[2] * (width / wavelength) ** 2)\n    \n    # Adjust amplitude envelope for better fit by introducing another Gaussian term\n    amplitude_envelope = (params[3] * np.exp(-((width - params[4]) ** 2) / (2 * params[5] ** 2))) + (params[6] * np.exp(-((width - params[7]) ** 2) / (2 * params[8] ** 2)))\n    \n    # Introduce a phase shift that depends on the wavelength to account for different material properties\n    frequency_shift = params[9] * np.cos(params[10] * width / wavelength + params[11] * wavelength)\n    \n    # Combine all terms considering their interactions\n    combined_term = phase_modulation + amplitude_envelope + frequency_shift\n    \n    # Normalize the sinc argument with a wavelength-dependent factor to ensure proper scaling\n    sinc_argument = (combined_term / (params[12] * wavelength))\n    \n    # Use sinc function squared for efficiency calculation, ensuring non-negative output\n    sinc_term = np.sinc(sinc_argument)\n    efficiency = params[13] * (sinc_term ** 2) + params[14]\n    return efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 9, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Enhance phase modulation with a quadratic term to capture non-linear effects\n    phase_modulation = params[0] * np.sin(params[1] * width / wavelength + params[2] * (width / wavelength) ** 2)\n    \n    # Adjust amplitude envelope for better fit by introducing another Gaussian term\n    amplitude_envelope = (params[3] * np.exp(-((width - params[4]) ** 2) / (2 * params[5] ** 2))) + (params[6] * np.exp(-((width - params[7]) ** 2) / (2 * params[8] ** 2)))\n    \n    # Introduce a phase shift that depends on the wavelength to account for different material properties\n    frequency_shift = params[9] * np.cos(params[10] * width / wavelength + params[11] * wavelength)\n    \n    # Combine all terms considering their interactions\n    combined_term = phase_modulation + amplitude_envelope + frequency_shift\n    \n    # Normalize the sinc argument with a wavelength-dependent factor to ensure proper scaling\n    sinc_argument = (combined_term / (params[12] * wavelength))\n    \n    # Use sinc function squared for efficiency calculation, ensuring non-negative output\n    sinc_term = np.sinc(sinc_argument)\n    efficiency = params[13] * (sinc_term ** 2) + params[14]\n    return efficiency')
Error during mutation/evaluation for island 0x7f205b3528a0: Non-finite scores detected. Problematic clusters -> [index 10: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)
    sinc_term = np.sinc(normalized_wavelength)**2
    phase_shift = 2 * np.pi * (params[2] * width + params[3] * wavelength) + params[4] * np.sin(params[5] * wavelength)
    envelope_term = np.exp(-params[6] * (width - params[7])**2) * np.cos(2 * np.pi * params[8] * wavelength)**2
    efficiency = sinc_term * np.exp(-1j * phase_shift)**2 * envelope_term * params[9]
    return np.abs(efficiency)**2']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 10: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)
    sinc_term = np.sinc(normalized_wavelength)**2
    phase_shift = 2 * np.pi * (params[2] * width + params[3] * wavelength) + params[4] * np.sin(params[5] * wavelength)
    envelope_term = np.exp(-params[6] * (width - params[7])**2) * np.cos(2 * np.pi * params[8] * wavelength)**2
    efficiency = sinc_term * np.exp(-1j * phase_shift)**2 * envelope_term * params[9]
    return np.abs(efficiency)**2']
Error during mutation/evaluation for island 0x7f205b103d40: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f205b3528a0: Non-finite scores detected. Problematic clusters -> [index 10: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)
    sinc_term = np.sinc(normalized_wavelength)**2
    phase_shift = 2 * np.pi * (params[2] * width + params[3] * wavelength) + params[4] * np.sin(params[5] * wavelength)
    envelope_term = np.exp(-params[6] * (width - params[7])**2) * np.cos(2 * np.pi * params[8] * wavelength)**2
    efficiency = sinc_term * np.exp(-1j * phase_shift)**2 * envelope_term * params[9]
    return np.abs(efficiency)**2']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 10: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)
    sinc_term = np.sinc(normalized_wavelength)**2
    phase_shift = 2 * np.pi * (params[2] * width + params[3] * wavelength) + params[4] * np.sin(params[5] * wavelength)
    envelope_term = np.exp(-params[6] * (width - params[7])**2) * np.cos(2 * np.pi * params[8] * wavelength)**2
    efficiency = sinc_term * np.exp(-1j * phase_shift)**2 * envelope_term * params[9]
    return np.abs(efficiency)**2']
Error during mutation/evaluation for island 0x7f205b103d40: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f205b3528a0: Non-finite scores detected. Problematic clusters -> [index 10: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)
    sinc_term = np.sinc(normalized_wavelength)**2
    phase_shift = 2 * np.pi * (params[2] * width + params[3] * wavelength) + params[4] * np.sin(params[5] * wavelength)
    envelope_term = np.exp(-params[6] * (width - params[7])**2) * np.cos(2 * np.pi * params[8] * wavelength)**2
    efficiency = sinc_term * np.exp(-1j * phase_shift)**2 * envelope_term * params[9]
    return np.abs(efficiency)**2']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 10: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)
    sinc_term = np.sinc(normalized_wavelength)**2
    phase_shift = 2 * np.pi * (params[2] * width + params[3] * wavelength) + params[4] * np.sin(params[5] * wavelength)
    envelope_term = np.exp(-params[6] * (width - params[7])**2) * np.cos(2 * np.pi * params[8] * wavelength)**2
    efficiency = sinc_term * np.exp(-1j * phase_shift)**2 * envelope_term * params[9]
    return np.abs(efficiency)**2']
<ast>:13: RuntimeWarning: overflow encountered in exp
/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_numdiff.py:596: RuntimeWarning: invalid value encountered in subtract
  df = fun(x1) - f0
<ast>:13: RuntimeWarning: overflow encountered in exp
<ast>:16: RuntimeWarning: overflow encountered in power
Error during mutation/evaluation for island 0x7f205b103d40: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f205b3528a0: Non-finite scores detected. Problematic clusters -> [index 10: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)
    sinc_term = np.sinc(normalized_wavelength)**2
    phase_shift = 2 * np.pi * (params[2] * width + params[3] * wavelength) + params[4] * np.sin(params[5] * wavelength)
    envelope_term = np.exp(-params[6] * (width - params[7])**2) * np.cos(2 * np.pi * params[8] * wavelength)**2
    efficiency = sinc_term * np.exp(-1j * phase_shift)**2 * envelope_term * params[9]
    return np.abs(efficiency)**2']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 10: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)
    sinc_term = np.sinc(normalized_wavelength)**2
    phase_shift = 2 * np.pi * (params[2] * width + params[3] * wavelength) + params[4] * np.sin(params[5] * wavelength)
    envelope_term = np.exp(-params[6] * (width - params[7])**2) * np.cos(2 * np.pi * params[8] * wavelength)**2
    efficiency = sinc_term * np.exp(-1j * phase_shift)**2 * envelope_term * params[9]
    return np.abs(efficiency)**2']
Error during mutation/evaluation for island 0x7f205b103d40: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f20597a7590: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the fundamental frequency mismatch parameter\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    # Define the sinc-like function component with phase shift and broadening consideration\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    # Calculate the SHG efficiency using a more physically accurate formula, considering nonlinear effects and higher-order interactions\n    shg_efficiency = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2)) + params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8]) + params[9] * k_mismatch**2\n    # Introduce a term that accounts for the group velocity mismatch affecting the efficiency\n    group_velocity_factor = params[10] * np.sin(k_mismatch)**2\n    shg_efficiency *= np.exp(-group_velocity_factor)\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 11, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the fundamental frequency mismatch parameter\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    # Define the sinc-like function component with phase shift and broadening consideration\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    # Calculate the SHG efficiency using a more physically accurate formula, considering nonlinear effects and higher-order interactions\n    shg_efficiency = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2)) + params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8]) + params[9] * k_mismatch**2\n    # Introduce a term that accounts for the group velocity mismatch affecting the efficiency\n    group_velocity_factor = params[10] * np.sin(k_mismatch)**2\n    shg_efficiency *= np.exp(-group_velocity_factor)\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f205b3528a0: Non-finite scores detected. Problematic clusters -> [index 10: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)
    sinc_term = np.sinc(normalized_wavelength)**2
    phase_shift = 2 * np.pi * (params[2] * width + params[3] * wavelength) + params[4] * np.sin(params[5] * wavelength)
    envelope_term = np.exp(-params[6] * (width - params[7])**2) * np.cos(2 * np.pi * params[8] * wavelength)**2
    efficiency = sinc_term * np.exp(-1j * phase_shift)**2 * envelope_term * params[9]
    return np.abs(efficiency)**2']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 10: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)
    sinc_term = np.sinc(normalized_wavelength)**2
    phase_shift = 2 * np.pi * (params[2] * width + params[3] * wavelength) + params[4] * np.sin(params[5] * wavelength)
    envelope_term = np.exp(-params[6] * (width - params[7])**2) * np.cos(2 * np.pi * params[8] * wavelength)**2
    efficiency = sinc_term * np.exp(-1j * phase_shift)**2 * envelope_term * params[9]
    return np.abs(efficiency)**2']
Error during mutation/evaluation for island 0x7f205b103d40: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f205b3528a0: Non-finite scores detected. Problematic clusters -> [index 10: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)
    sinc_term = np.sinc(normalized_wavelength)**2
    phase_shift = 2 * np.pi * (params[2] * width + params[3] * wavelength) + params[4] * np.sin(params[5] * wavelength)
    envelope_term = np.exp(-params[6] * (width - params[7])**2) * np.cos(2 * np.pi * params[8] * wavelength)**2
    efficiency = sinc_term * np.exp(-1j * phase_shift)**2 * envelope_term * params[9]
    return np.abs(efficiency)**2']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 10: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    normalized_wavelength = (wavelength - params[0]) / (params[1] * width)
    sinc_term = np.sinc(normalized_wavelength)**2
    phase_shift = 2 * np.pi * (params[2] * width + params[3] * wavelength) + params[4] * np.sin(params[5] * wavelength)
    envelope_term = np.exp(-params[6] * (width - params[7])**2) * np.cos(2 * np.pi * params[8] * wavelength)**2
    efficiency = sinc_term * np.exp(-1j * phase_shift)**2 * envelope_term * params[9]
    return np.abs(efficiency)**2']
Error during mutation/evaluation for island 0x7f205b0ba6f0: ('関数の実行中にエラーが発生しました', 'def equation_v1(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    \n    # Introduce a more physical model for the SHG efficiency, considering nonlinear effects and higher-order interactions\n    shg_efficiency = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2)) + params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8]) + params[9] * k_mismatch**2\n    \n    # Enhance the model with a higher-order interaction term\n    higher_order_interaction = params[10] * sinc_component**4 * np.exp(-(width**2 + wavelength**2) / (2 * params[11]**2))\n    \n    # Combine all components to get a more physically accurate SHG efficiency\n    total_shg_efficiency = shg_efficiency + higher_order_interaction\n    return total_shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 11, in equation_v1
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v1(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    \n    # Introduce a more physical model for the SHG efficiency, considering nonlinear effects and higher-order interactions\n    shg_efficiency = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2)) + params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8]) + params[9] * k_mismatch**2\n    \n    # Enhance the model with a higher-order interaction term\n    higher_order_interaction = params[10] * sinc_component**4 * np.exp(-(width**2 + wavelength**2) / (2 * params[11]**2))\n    \n    # Combine all components to get a more physically accurate SHG efficiency\n    total_shg_efficiency = shg_efficiency + higher_order_interaction\n    return total_shg_efficiency')
Error during mutation/evaluation for island 0x7f205b103d40: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f205b0b9670: ('関数の実行中にエラーが発生しました', 'def equation_v1(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    nonlinear_effect = np.exp(-k_mismatch**2 / (2 * params[3]**2))  # Adding a Gaussian-like nonlinear effect\n    shg_efficiency = params[4] * sinc_component**2 * nonlinear_effect * np.exp(-width**2 / (2 * params[5]**2)) + params[6] * wavelength**(-params[7]) + params[8] * width**(-params[9]) + params[10] * k_mismatch**2\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 7, in equation_v1
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v1(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    nonlinear_effect = np.exp(-k_mismatch**2 / (2 * params[3]**2))  # Adding a Gaussian-like nonlinear effect\n    shg_efficiency = params[4] * sinc_component**2 * nonlinear_effect * np.exp(-width**2 / (2 * params[5]**2)) + params[6] * wavelength**(-params[7]) + params[8] * width**(-params[9]) + params[10] * k_mismatch**2\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f205b103d40: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f20597a7590: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the fundamental frequency mismatch parameter\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    # Define the sinc-like function component with phase shift and broadening consideration\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    # Calculate the SHG efficiency considering nonlinear effects, higher-order interactions, and group velocity mismatch\n    shg_efficiency = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2)) + params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8]) + params[9] * k_mismatch**2\n    # Apply an additional correction factor to account for material nonlinearity and phase matching efficiency\n    shg_efficiency *= np.exp(-k_mismatch**2 / (4 * params[10]))\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 11, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the fundamental frequency mismatch parameter\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    # Define the sinc-like function component with phase shift and broadening consideration\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    # Calculate the SHG efficiency considering nonlinear effects, higher-order interactions, and group velocity mismatch\n    shg_efficiency = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2)) + params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8]) + params[9] * k_mismatch**2\n    # Apply an additional correction factor to account for material nonlinearity and phase matching efficiency\n    shg_efficiency *= np.exp(-k_mismatch**2 / (4 * params[10]))\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f205b0b9670: ('関数の実行中にエラーが発生しました', 'def equation_v1(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the fundamental frequency mismatch parameter\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    # Define the sinc-like function component with phase shift and broadening consideration\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    # Calculate the SHG efficiency considering nonlinear effects, higher-order interactions, and domain width scaling\n    shg_efficiency = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2)) + params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8]) + params[9] * k_mismatch**2\n    # Introduce a scaling factor based on domain width to better represent the physical properties of the device\n    domain_scaling_factor = np.exp(-width / (params[10] * wavelength))\n    shg_efficiency *= domain_scaling_factor\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 11, in equation_v1
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v1(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the fundamental frequency mismatch parameter\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    # Define the sinc-like function component with phase shift and broadening consideration\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    # Calculate the SHG efficiency considering nonlinear effects, higher-order interactions, and domain width scaling\n    shg_efficiency = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2)) + params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8]) + params[9] * k_mismatch**2\n    # Introduce a scaling factor based on domain width to better represent the physical properties of the device\n    domain_scaling_factor = np.exp(-width / (params[10] * wavelength))\n    shg_efficiency *= domain_scaling_factor\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f205b103d40: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f205b103d40: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f205b0ba360: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the fundamental frequency mismatch parameter\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    # Define the sinc-like function component with phase shift and broadening consideration\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))\n    # Calculate the SHG efficiency using a more physically accurate formula, considering nonlinear effects and higher-order interactions\n    shg_efficiency = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2)) * np.cos(params[5] * k_mismatch)**2 + params[6] * wavelength**(-params[7]) + params[8] * width**(-params[9]) + params[10] * k_mismatch**3\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 9, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the fundamental frequency mismatch parameter\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    # Define the sinc-like function component with phase shift and broadening consideration\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))\n    # Calculate the SHG efficiency using a more physically accurate formula, considering nonlinear effects and higher-order interactions\n    shg_efficiency = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2)) * np.cos(params[5] * k_mismatch)**2 + params[6] * wavelength**(-params[7]) + params[8] * width**(-params[9]) + params[10] * k_mismatch**3\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f205b103d40: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f20597a6690: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    nonlinear_effect = params[3] * sinc_component**2 * gaussian_broadening\n    gaussian_broadening = np.exp(-width**2 / (2 * params[4]**2))\n    background_correction = params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8])\n    shg_efficiency = nonlinear_effect - background_correction + params[9] * k_mismatch**2\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 6, in equation_v2
UnboundLocalError: cannot access local variable 'gaussian_broadening' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    nonlinear_effect = params[3] * sinc_component**2 * gaussian_broadening\n    gaussian_broadening = np.exp(-width**2 / (2 * params[4]**2))\n    background_correction = params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8])\n    shg_efficiency = nonlinear_effect - background_correction + params[9] * k_mismatch**2\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f205b07d160: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    non_linear_effect = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2))\n    higher_order_interactions = params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8])\n    phase_matching_effect = params[9] * k_mismatch**2\n    # Introducing a damping factor to account for energy loss in the device\n    damping_factor = np.exp(-width / params[10])\n    shg_efficiency = (non_linear_effect + higher_order_interactions + phase_matching_effect) * damping_factor\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 10, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    non_linear_effect = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2))\n    higher_order_interactions = params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8])\n    phase_matching_effect = params[9] * k_mismatch**2\n    # Introducing a damping factor to account for energy loss in the device\n    damping_factor = np.exp(-width / params[10])\n    shg_efficiency = (non_linear_effect + higher_order_interactions + phase_matching_effect) * damping_factor\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f205b0ba360: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / broadening_factor)\n    shg_efficiency = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2)) * np.cos(params[5] * k_mismatch)**2 + params[6] * wavelength**(-params[7]) + params[8] * width**(-params[9]) + params[10] * k_mismatch**4\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 6, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / broadening_factor)\n    shg_efficiency = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2)) * np.cos(params[5] * k_mismatch)**2 + params[6] * wavelength**(-params[7]) + params[8] * width**(-params[9]) + params[10] * k_mismatch**4\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f205b103d40: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f205b07d160: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    non_linear_effect = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2))\n    higher_order_interactions = params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8])\n    phase_matching_effect = params[9] * k_mismatch**2\n    # Incorporating a correction factor based on experimental data for better accuracy\n    correction_factor = params[10] * np.cos(params[11] * wavelength + params[12] * width)\n    shg_efficiency = non_linear_effect + higher_order_interactions + phase_matching_effect + correction_factor\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 10, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    non_linear_effect = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2))\n    higher_order_interactions = params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8])\n    phase_matching_effect = params[9] * k_mismatch**2\n    # Incorporating a correction factor based on experimental data for better accuracy\n    correction_factor = params[10] * np.cos(params[11] * wavelength + params[12] * width)\n    shg_efficiency = non_linear_effect + higher_order_interactions + phase_matching_effect + correction_factor\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f205b0ba360: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))\n    nonlinear_effect = params[3] * sinc_component**2\n    gaussian_broadening = np.exp(-width**2 / (2 * params[4]**2))\n    higher_order_interaction = params[5] * k_mismatch**params[6]\n    shg_efficiency = nonlinear_effect * gaussian_broadening + higher_order_interaction + params[7] * wavelength**(-params[8]) + params[9] * width**(-params[10])\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 9, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))\n    nonlinear_effect = params[3] * sinc_component**2\n    gaussian_broadening = np.exp(-width**2 / (2 * params[4]**2))\n    higher_order_interaction = params[5] * k_mismatch**params[6]\n    shg_efficiency = nonlinear_effect * gaussian_broadening + higher_order_interaction + params[7] * wavelength**(-params[8]) + params[9] * width**(-params[10])\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f205b103d40: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f205b0ba6f0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n\n    # Adjust the SHG efficiency calculation to better reflect physical reality:\n    shg_efficiency = params[3] * sinc_component**2  # Maintain the importance of sinc function in efficiency\n    shg_efficiency *= np.exp(-k_mismatch**2 / (2 * params[4]**2))  # Use k_mismatch directly for exponential factor, emphasizing phase matching quality\n    shg_efficiency += params[5] * wavelength**(-params[6])  # Keep the inverse power law term for wavelength dependence\n    shg_efficiency *= np.exp(-(width - params[7])**2 / (2 * params[8]**2))  # Use a Gaussian centered around an optimal width parameter, allowing flexibility in domain design\n    shg_efficiency += params[9] * (width**params[10])  # Add polynomial term to account for potential nonlinear effects on efficiency with domain size\n\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 12, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n\n    # Adjust the SHG efficiency calculation to better reflect physical reality:\n    shg_efficiency = params[3] * sinc_component**2  # Maintain the importance of sinc function in efficiency\n    shg_efficiency *= np.exp(-k_mismatch**2 / (2 * params[4]**2))  # Use k_mismatch directly for exponential factor, emphasizing phase matching quality\n    shg_efficiency += params[5] * wavelength**(-params[6])  # Keep the inverse power law term for wavelength dependence\n    shg_efficiency *= np.exp(-(width - params[7])**2 / (2 * params[8]**2))  # Use a Gaussian centered around an optimal width parameter, allowing flexibility in domain design\n    shg_efficiency += params[9] * (width**params[10])  # Add polynomial term to account for potential nonlinear effects on efficiency with domain size\n\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f205b103d40: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f205b0ba6f0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the fundamental frequency mismatch parameter\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    # Define the sinc-like function component with phase shift and broadening consideration\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    # Calculate the SHG efficiency using a more physically accurate formula, considering nonlinear effects and higher-order interactions\n    shg_efficiency = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2)) + params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8]) - params[9] * k_mismatch**2\n    # Introduce a higher-order interaction term to account for nonlinear effects more accurately\n    higher_order_interaction = np.sin(params[10] * k_mismatch)**2\n    shg_efficiency += params[11] * higher_order_interaction\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 11, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the fundamental frequency mismatch parameter\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    # Define the sinc-like function component with phase shift and broadening consideration\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    # Calculate the SHG efficiency using a more physically accurate formula, considering nonlinear effects and higher-order interactions\n    shg_efficiency = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2)) + params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8]) - params[9] * k_mismatch**2\n    # Introduce a higher-order interaction term to account for nonlinear effects more accurately\n    higher_order_interaction = np.sin(params[10] * k_mismatch)**2\n    shg_efficiency += params[11] * higher_order_interaction\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f205b103d40: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f205b103d40: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f205b3216d0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the fundamental frequency mismatch parameter\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    # Define the sinc-like function component with phase shift and broadening consideration\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    # Calculate the Gaussian decay term based on domain width\n    gaussian_decay = np.exp(-width**2 / (2 * params[3]**2))\n    # Incorporate nonlinear effects with a modified SRS effect\n    srs_effect = params[4] * wavelength**(-params[5]) + params[6] * k_mismatch**2\n    # Include higher-order corrections to the efficiency calculation, weighted by an additional parameter\n    higher_order_correction = params[7] * width**(-params[8]) * np.exp(-k_mismatch**2 / (2 * params[9]**2))\n    # Combine all components to calculate SHG efficiency with improved physical accuracy\n    shg_efficiency = params[10] * sinc_component**2 * gaussian_decay + srs_effect + higher_order_correction\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 15, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the fundamental frequency mismatch parameter\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    # Define the sinc-like function component with phase shift and broadening consideration\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    # Calculate the Gaussian decay term based on domain width\n    gaussian_decay = np.exp(-width**2 / (2 * params[3]**2))\n    # Incorporate nonlinear effects with a modified SRS effect\n    srs_effect = params[4] * wavelength**(-params[5]) + params[6] * k_mismatch**2\n    # Include higher-order corrections to the efficiency calculation, weighted by an additional parameter\n    higher_order_correction = params[7] * width**(-params[8]) * np.exp(-k_mismatch**2 / (2 * params[9]**2))\n    # Combine all components to calculate SHG efficiency with improved physical accuracy\n    shg_efficiency = params[10] * sinc_component**2 * gaussian_decay + srs_effect + higher_order_correction\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f205b103d40: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f205b103d40: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f205b0b9d00: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / broadening_factor)\n    nonlinear_effect = params[3] * sinc_component**2\n    exp_decay = np.exp(-width**2 / (2 * params[4]**2))\n    wavelength_effect = params[5] * (wavelength / params[6])**params[7]\n    width_effect = params[8] * (width / params[9])**params[10]\n    shg_efficiency = nonlinear_effect * exp_decay + wavelength_effect + width_effect\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 9, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / broadening_factor)\n    nonlinear_effect = params[3] * sinc_component**2\n    exp_decay = np.exp(-width**2 / (2 * params[4]**2))\n    wavelength_effect = params[5] * (wavelength / params[6])**params[7]\n    width_effect = params[8] * (width / params[9])**params[10]\n    shg_efficiency = nonlinear_effect * exp_decay + wavelength_effect + width_effect\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f205b103d40: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f205b103d40: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f205b103d40: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f205b103d40: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f205977f1d0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the fundamental frequency mismatch parameter\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    # Define the sinc-like function component with phase shift and broadening consideration\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))\n    # Calculate the SHG efficiency using a more physically accurate formula, considering nonlinear effects and higher-order interactions\n    shg_efficiency = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2)) + params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8]) + params[9] * k_mismatch**2\n    # Correct the sign for higher-order interactions term to ensure physical accuracy\n    shg_efficiency -= params[10] * (k_mismatch**2)**2\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 11, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the fundamental frequency mismatch parameter\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    # Define the sinc-like function component with phase shift and broadening consideration\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))\n    # Calculate the SHG efficiency using a more physically accurate formula, considering nonlinear effects and higher-order interactions\n    shg_efficiency = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2)) + params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8]) + params[9] * k_mismatch**2\n    # Correct the sign for higher-order interactions term to ensure physical accuracy\n    shg_efficiency -= params[10] * (k_mismatch**2)**2\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f205b07d160: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the fundamental frequency mismatch parameter\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    # Define the sinc-like function component with phase shift and broadening consideration\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    # Calculate non-linear effects more accurately by incorporating a quadratic term for k_mismatch\n    non_linear_effect = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2)) * (1 + params[5] * k_mismatch**2)\n    # Higher-order interactions, now weighted by a Gaussian factor to account for spatial coherence\n    higher_order_interactions = params[6] * wavelength**(-params[7]) * np.exp(-(wavelength - params[8])**2 / (2 * params[9]**2)) + params[10] * width**(-params[11])\n    # Phase matching effect, considering a quadratic term for better approximation\n    phase_matching_effect = params[12] * k_mismatch**2 * np.exp(-(k_mismatch - params[13])**2 / (2 * params[14]**2))\n    # Calculate the SHG efficiency as the sum of the non-linear effects, higher-order interactions, and phase matching effect\n    shg_efficiency = non_linear_effect + higher_order_interactions + phase_matching_effect\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 11, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the fundamental frequency mismatch parameter\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    # Define the sinc-like function component with phase shift and broadening consideration\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    # Calculate non-linear effects more accurately by incorporating a quadratic term for k_mismatch\n    non_linear_effect = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2)) * (1 + params[5] * k_mismatch**2)\n    # Higher-order interactions, now weighted by a Gaussian factor to account for spatial coherence\n    higher_order_interactions = params[6] * wavelength**(-params[7]) * np.exp(-(wavelength - params[8])**2 / (2 * params[9]**2)) + params[10] * width**(-params[11])\n    # Phase matching effect, considering a quadratic term for better approximation\n    phase_matching_effect = params[12] * k_mismatch**2 * np.exp(-(k_mismatch - params[13])**2 / (2 * params[14]**2))\n    # Calculate the SHG efficiency as the sum of the non-linear effects, higher-order interactions, and phase matching effect\n    shg_efficiency = non_linear_effect + higher_order_interactions + phase_matching_effect\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f205b103d40: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f205b0ba6f0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the fundamental frequency mismatch parameter\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    \n    # Define the sinc-like function component with phase shift and broadening consideration\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    \n    # Calculate the SHG efficiency using a more physically accurate formula, considering nonlinear effects and higher-order interactions\n    shg_efficiency = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2)) + params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8]) + params[9] * k_mismatch**2\n    \n    # Introduce an additional term to account for the effects of temperature on SHG efficiency\n    temperature_factor = np.exp(-params[10] * (width - params[11])**2)\n    shg_efficiency *= temperature_factor\n    \n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 14, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the fundamental frequency mismatch parameter\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    \n    # Define the sinc-like function component with phase shift and broadening consideration\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    \n    # Calculate the SHG efficiency using a more physically accurate formula, considering nonlinear effects and higher-order interactions\n    shg_efficiency = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2)) + params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8]) + params[9] * k_mismatch**2\n    \n    # Introduce an additional term to account for the effects of temperature on SHG efficiency\n    temperature_factor = np.exp(-params[10] * (width - params[11])**2)\n    shg_efficiency *= temperature_factor\n    \n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f205b0ba6f0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    shg_efficiency = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2)) + params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8]) + params[9] * k_mismatch**2 + params[10] * np.cos(2 * np.pi * width / params[11])\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 6, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    shg_efficiency = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2)) + params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8]) + params[9] * k_mismatch**2 + params[10] * np.cos(2 * np.pi * width / params[11])\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f205b103d40: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 4: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))
    nonlinear_term = params[3] * k_mismatch**4 * np.exp(-width**2 / (2 * params[4]**2))
    higher_order_interaction = params[5] * wavelength**(-params[6]) * width**(-params[7])
    shg_efficiency = sinc_component**2 + nonlinear_term + higher_order_interaction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f205b07d160: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    non_linear_effect = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2))\n    higher_order_interactions = params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8])\n    phase_matching_effect = params[9] * k_mismatch**2\n    shg_efficiency = non_linear_effect * np.exp(-k_mismatch**2 / (2 * params[10]**2)) + higher_order_interactions * np.cos(params[11] * k_mismatch) + phase_matching_effect * np.sin(params[12] * width)\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 9, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    non_linear_effect = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2))\n    higher_order_interactions = params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8])\n    phase_matching_effect = params[9] * k_mismatch**2\n    shg_efficiency = non_linear_effect * np.exp(-k_mismatch**2 / (2 * params[10]**2)) + higher_order_interactions * np.cos(params[11] * k_mismatch) + phase_matching_effect * np.sin(params[12] * width)\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f205b3216d0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    gaussian_decay = np.exp(-width**2 / (2 * params[3]**2))\n    srs_effect = params[4] * wavelength**(-params[5])\n    higher_order_correction = params[6] * k_mismatch**2 + params[7] * width**(-params[8])\n    shg_efficiency = params[9] * sinc_component**2 * gaussian_decay * np.exp(-k_mismatch**2 / (2 * params[10]**2)) + srs_effect + higher_order_correction\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 9, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    gaussian_decay = np.exp(-width**2 / (2 * params[3]**2))\n    srs_effect = params[4] * wavelength**(-params[5])\n    higher_order_correction = params[6] * k_mismatch**2 + params[7] * width**(-params[8])\n    shg_efficiency = params[9] * sinc_component**2 * gaussian_decay * np.exp(-k_mismatch**2 / (2 * params[10]**2)) + srs_effect + higher_order_correction\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f205b07d160: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the fundamental frequency mismatch parameter\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    # Define the sinc-like function component with phase shift and broadening consideration\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    # Calculate the nonlinear effect contribution to SHG efficiency\n    non_linear_effect = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2))\n    # Account for higher-order interactions affecting SHG efficiency\n    higher_order_interactions = params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8])\n    # Consider the phase matching effect due to k_mismatch\n    phase_matching_effect = params[9] * k_mismatch**2 * np.exp(-(k_mismatch / params[10])**2)\n    # Combine all effects to determine the final SHG efficiency\n    shg_efficiency = non_linear_effect + higher_order_interactions + phase_matching_effect\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 13, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the fundamental frequency mismatch parameter\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    # Define the sinc-like function component with phase shift and broadening consideration\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    # Calculate the nonlinear effect contribution to SHG efficiency\n    non_linear_effect = params[3] * sinc_component**2 * np.exp(-width**2 / (2 * params[4]**2))\n    # Account for higher-order interactions affecting SHG efficiency\n    higher_order_interactions = params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8])\n    # Consider the phase matching effect due to k_mismatch\n    phase_matching_effect = params[9] * k_mismatch**2 * np.exp(-(k_mismatch / params[10])**2)\n    # Combine all effects to determine the final SHG efficiency\n    shg_efficiency = non_linear_effect + higher_order_interactions + phase_matching_effect\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f20597a56d0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate k_mismatch with a more precise phase matching condition\n    k_mismatch = (np.pi / wavelength - np.pi / (params[0] * width)) * params[1]\n    \n    # Introduce a sinusoidal term to account for potential frequency detuning effects\n    sinusoidal_term = np.sin(params[2] * width + params[3])\n    \n    # Modify the sinc component to incorporate both k_mismatch and phase shift more effectively\n    sinc_component = np.sinc((k_mismatch + params[4] * wavelength) / (params[5] * (width**params[6])))\n    \n    # Enhance nonlinear effect by adding a quadratic term for better fit\n    nonlinear_effect = params[7] * sinc_component**2 + params[8] * sinc_component**4\n    \n    # Adjust gaussian broadening to be more sensitive to domain width variations\n    gaussian_broadening = np.exp(-width**params[9] / (2 * params[10]**2))\n    \n    # Introduce a wavelength-dependent background correction term for better accuracy\n    background_correction = (params[11] * wavelength**(-params[12]) + params[13] * width**(-params[14])) * np.exp(-params[15] / wavelength)\n    \n    # Calculate SHG efficiency with a refined formula\n    shg_efficiency = nonlinear_effect * gaussian_broadening - background_correction + params[16] * k_mismatch**2 + params[17] * sinusoidal_term**2\n    \n    # Ensure the efficiency remains non-negative\n    return np.clip(shg_efficiency, 0, None)')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 15, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate k_mismatch with a more precise phase matching condition\n    k_mismatch = (np.pi / wavelength - np.pi / (params[0] * width)) * params[1]\n    \n    # Introduce a sinusoidal term to account for potential frequency detuning effects\n    sinusoidal_term = np.sin(params[2] * width + params[3])\n    \n    # Modify the sinc component to incorporate both k_mismatch and phase shift more effectively\n    sinc_component = np.sinc((k_mismatch + params[4] * wavelength) / (params[5] * (width**params[6])))\n    \n    # Enhance nonlinear effect by adding a quadratic term for better fit\n    nonlinear_effect = params[7] * sinc_component**2 + params[8] * sinc_component**4\n    \n    # Adjust gaussian broadening to be more sensitive to domain width variations\n    gaussian_broadening = np.exp(-width**params[9] / (2 * params[10]**2))\n    \n    # Introduce a wavelength-dependent background correction term for better accuracy\n    background_correction = (params[11] * wavelength**(-params[12]) + params[13] * width**(-params[14])) * np.exp(-params[15] / wavelength)\n    \n    # Calculate SHG efficiency with a refined formula\n    shg_efficiency = nonlinear_effect * gaussian_broadening - background_correction + params[16] * k_mismatch**2 + params[17] * sinusoidal_term**2\n    \n    # Ensure the efficiency remains non-negative\n    return np.clip(shg_efficiency, 0, None)')
Error during mutation/evaluation for island 0x7f205b07d160: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    non_linear_effect = params[3] * sinc_component**4\n    higher_order_interactions = params[4] * wavelength**(-params[5]) + params[6] * width**(-params[7])\n    phase_matching_effect = params[8] * k_mismatch**2\n    gaussian_broadening = np.exp(-(width - params[9])**2 / (2 * params[10]**2))\n    shg_efficiency = non_linear_effect * higher_order_interactions * gaussian_broadening + phase_matching_effect\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 9, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    non_linear_effect = params[3] * sinc_component**4\n    higher_order_interactions = params[4] * wavelength**(-params[5]) + params[6] * width**(-params[7])\n    phase_matching_effect = params[8] * k_mismatch**2\n    gaussian_broadening = np.exp(-(width - params[9])**2 / (2 * params[10]**2))\n    shg_efficiency = non_linear_effect * higher_order_interactions * gaussian_broadening + phase_matching_effect\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f20597a43b0: ('関数の実行中にエラーが発生しました', "def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Update k_mismatch to better account for phase matching\n    k_mismatch = 2 * np.pi / wavelength - (params[0] + params[1]) * 2 * np.pi / width\n    \n    # Adjust the sinc function's broadening factor based on material properties\n    sinc_component = np.sinc((k_mismatch) / (params[2]))\n    \n    # Introduce a nonlinearity correction factor to better represent physical reality\n    nonlinear_effect = params[3] * sinc_component**2 * (1 + params[4] * k_mismatch**2)\n    \n    # Enhance Gaussian broadening term with an additional width dependency parameter for more precise modeling\n    gaussian_broadening = np.exp(-(width - params[5])**2 / (2 * params[6]**2))\n    \n    # Refine background correction to incorporate both wavelength and width dependencies more accurately\n    background_correction = params[7] * wavelength**(-params[8]) + params[9] * width**(-params[10]) + params[11]\n    \n    # Combine all factors to compute SHG efficiency with improved physical accuracy\n    shg_efficiency = nonlinear_effect * gaussian_broadening - background_correction + params[12] * k_mismatch**2\n    return shg_efficiency")
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 15, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', "def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Update k_mismatch to better account for phase matching\n    k_mismatch = 2 * np.pi / wavelength - (params[0] + params[1]) * 2 * np.pi / width\n    \n    # Adjust the sinc function's broadening factor based on material properties\n    sinc_component = np.sinc((k_mismatch) / (params[2]))\n    \n    # Introduce a nonlinearity correction factor to better represent physical reality\n    nonlinear_effect = params[3] * sinc_component**2 * (1 + params[4] * k_mismatch**2)\n    \n    # Enhance Gaussian broadening term with an additional width dependency parameter for more precise modeling\n    gaussian_broadening = np.exp(-(width - params[5])**2 / (2 * params[6]**2))\n    \n    # Refine background correction to incorporate both wavelength and width dependencies more accurately\n    background_correction = params[7] * wavelength**(-params[8]) + params[9] * width**(-params[10]) + params[11]\n    \n    # Combine all factors to compute SHG efficiency with improved physical accuracy\n    shg_efficiency = nonlinear_effect * gaussian_broadening - background_correction + params[12] * k_mismatch**2\n    return shg_efficiency")
<ast>:13: RuntimeWarning: invalid value encountered in power
<ast>:13: RuntimeWarning: overflow encountered in power
/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_numdiff.py:596: RuntimeWarning: invalid value encountered in subtract
  df = fun(x1) - f0
<ast>:13: RuntimeWarning: invalid value encountered in power
<ast>:13: RuntimeWarning: invalid value encountered in power
<ast>:13: RuntimeWarning: invalid value encountered in power
<ast>:11: RuntimeWarning: overflow encountered in power
<ast>:11: RuntimeWarning: overflow encountered in multiply
<ast>:13: RuntimeWarning: overflow encountered in power
<ast>:15: RuntimeWarning: invalid value encountered in add
<ast>:13: RuntimeWarning: invalid value encountered in power
<ast>:11: RuntimeWarning: overflow encountered in power
<ast>:13: RuntimeWarning: overflow encountered in power
<ast>:15: RuntimeWarning: invalid value encountered in add
<ast>:13: RuntimeWarning: invalid value encountered in power
<ast>:13: RuntimeWarning: invalid value encountered in power
Error during mutation/evaluation for island 0x7f205b3216d0: Non-finite scores detected. Problematic clusters -> [index 38: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    # Calculate the fundamental frequency mismatch parameter
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    # Define the sinc-like function component with phase shift and broadening consideration
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))
    # Calculate the Gaussian decay factor considering nonlinear broadening effects
    gaussian_decay = np.exp(-width**2 / (2 * params[3]**2))
    # Account for SRS effect with wavelength dependency and k-mismatch correction, refined term
    srs_effect = params[4] * wavelength**(-params[5]) * np.cos(params[6] * k_mismatch)
    # Incorporate higher-order corrections dependent on domain width, adjusted term
    higher_order_correction = params[7] * (width / params[8])**(-params[9])
    # Combine all components into the final SHG efficiency expression, ensuring physical accuracy
    shg_efficiency = sinc_component**2 * gaussian_decay + srs_effect + higher_order_correction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 38: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    # Calculate the fundamental frequency mismatch parameter
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    # Define the sinc-like function component with phase shift and broadening consideration
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))
    # Calculate the Gaussian decay factor considering nonlinear broadening effects
    gaussian_decay = np.exp(-width**2 / (2 * params[3]**2))
    # Account for SRS effect with wavelength dependency and k-mismatch correction, refined term
    srs_effect = params[4] * wavelength**(-params[5]) * np.cos(params[6] * k_mismatch)
    # Incorporate higher-order corrections dependent on domain width, adjusted term
    higher_order_correction = params[7] * (width / params[8])**(-params[9])
    # Combine all components into the final SHG efficiency expression, ensuring physical accuracy
    shg_efficiency = sinc_component**2 * gaussian_decay + srs_effect + higher_order_correction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f205b3216d0: Non-finite scores detected. Problematic clusters -> [index 38: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    # Calculate the fundamental frequency mismatch parameter
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    # Define the sinc-like function component with phase shift and broadening consideration
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))
    # Calculate the Gaussian decay factor considering nonlinear broadening effects
    gaussian_decay = np.exp(-width**2 / (2 * params[3]**2))
    # Account for SRS effect with wavelength dependency and k-mismatch correction, refined term
    srs_effect = params[4] * wavelength**(-params[5]) * np.cos(params[6] * k_mismatch)
    # Incorporate higher-order corrections dependent on domain width, adjusted term
    higher_order_correction = params[7] * (width / params[8])**(-params[9])
    # Combine all components into the final SHG efficiency expression, ensuring physical accuracy
    shg_efficiency = sinc_component**2 * gaussian_decay + srs_effect + higher_order_correction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 38: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    # Calculate the fundamental frequency mismatch parameter
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    # Define the sinc-like function component with phase shift and broadening consideration
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))
    # Calculate the Gaussian decay factor considering nonlinear broadening effects
    gaussian_decay = np.exp(-width**2 / (2 * params[3]**2))
    # Account for SRS effect with wavelength dependency and k-mismatch correction, refined term
    srs_effect = params[4] * wavelength**(-params[5]) * np.cos(params[6] * k_mismatch)
    # Incorporate higher-order corrections dependent on domain width, adjusted term
    higher_order_correction = params[7] * (width / params[8])**(-params[9])
    # Combine all components into the final SHG efficiency expression, ensuring physical accuracy
    shg_efficiency = sinc_component**2 * gaussian_decay + srs_effect + higher_order_correction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f20597a56d0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate k_mismatch considering the refractive index difference\n    n1 = params[0]\n    n2 = params[1]\n    k_mismatch = 2 * np.pi * (n1 - n2) / wavelength\n    \n    # Sinc-like function component for phase matching\n    phase_shift = params[2]\n    broadening_factor = params[3]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    \n    # Nonlinear effect contribution, considering the squared sinc component\n    nonlinear_effect = params[4] * sinc_component**2\n    \n    # Gaussian broadening factor to model smooth domain width effects\n    gaussian_broadening = np.exp(-width**2 / (2 * params[5]**2))\n    \n    # Background correction term based on wavelength and domain width, adjusted for physical accuracy\n    background_correction = params[6] * wavelength**(-params[7]) + params[8] * width**(-params[9])\n    \n    # Final SHG efficiency calculation, ensuring non-negative values\n    shg_efficiency = nonlinear_effect * gaussian_broadening - background_correction + params[10] * k_mismatch**2\n    return np.clip(shg_efficiency, 0, None)')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 22, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate k_mismatch considering the refractive index difference\n    n1 = params[0]\n    n2 = params[1]\n    k_mismatch = 2 * np.pi * (n1 - n2) / wavelength\n    \n    # Sinc-like function component for phase matching\n    phase_shift = params[2]\n    broadening_factor = params[3]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    \n    # Nonlinear effect contribution, considering the squared sinc component\n    nonlinear_effect = params[4] * sinc_component**2\n    \n    # Gaussian broadening factor to model smooth domain width effects\n    gaussian_broadening = np.exp(-width**2 / (2 * params[5]**2))\n    \n    # Background correction term based on wavelength and domain width, adjusted for physical accuracy\n    background_correction = params[6] * wavelength**(-params[7]) + params[8] * width**(-params[9])\n    \n    # Final SHG efficiency calculation, ensuring non-negative values\n    shg_efficiency = nonlinear_effect * gaussian_broadening - background_correction + params[10] * k_mismatch**2\n    return np.clip(shg_efficiency, 0, None)')
Error during mutation/evaluation for island 0x7f20597a6690: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    nonlinear_effect = params[3] * sinc_component**2\n    gaussian_broadening = np.exp(-width**2 / (2 * params[4]**2))\n    background_correction = params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8])\n    higher_order_interaction = params[9] * k_mismatch**2\n    # Enhance the model by introducing a coupling factor that accounts for nonlinear effects more accurately\n    coupling_factor = np.sin(params[10] * (k_mismatch + phase_shift))\n    shg_efficiency = nonlinear_effect * gaussian_broadening * coupling_factor - background_correction + higher_order_interaction\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 11, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    nonlinear_effect = params[3] * sinc_component**2\n    gaussian_broadening = np.exp(-width**2 / (2 * params[4]**2))\n    background_correction = params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8])\n    higher_order_interaction = params[9] * k_mismatch**2\n    # Enhance the model by introducing a coupling factor that accounts for nonlinear effects more accurately\n    coupling_factor = np.sin(params[10] * (k_mismatch + phase_shift))\n    shg_efficiency = nonlinear_effect * gaussian_broadening * coupling_factor - background_correction + higher_order_interaction\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f205b3216d0: Non-finite scores detected. Problematic clusters -> [index 38: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    # Calculate the fundamental frequency mismatch parameter
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    # Define the sinc-like function component with phase shift and broadening consideration
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))
    # Calculate the Gaussian decay factor considering nonlinear broadening effects
    gaussian_decay = np.exp(-width**2 / (2 * params[3]**2))
    # Account for SRS effect with wavelength dependency and k-mismatch correction, refined term
    srs_effect = params[4] * wavelength**(-params[5]) * np.cos(params[6] * k_mismatch)
    # Incorporate higher-order corrections dependent on domain width, adjusted term
    higher_order_correction = params[7] * (width / params[8])**(-params[9])
    # Combine all components into the final SHG efficiency expression, ensuring physical accuracy
    shg_efficiency = sinc_component**2 * gaussian_decay + srs_effect + higher_order_correction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 38: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    # Calculate the fundamental frequency mismatch parameter
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    # Define the sinc-like function component with phase shift and broadening consideration
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))
    # Calculate the Gaussian decay factor considering nonlinear broadening effects
    gaussian_decay = np.exp(-width**2 / (2 * params[3]**2))
    # Account for SRS effect with wavelength dependency and k-mismatch correction, refined term
    srs_effect = params[4] * wavelength**(-params[5]) * np.cos(params[6] * k_mismatch)
    # Incorporate higher-order corrections dependent on domain width, adjusted term
    higher_order_correction = params[7] * (width / params[8])**(-params[9])
    # Combine all components into the final SHG efficiency expression, ensuring physical accuracy
    shg_efficiency = sinc_component**2 * gaussian_decay + srs_effect + higher_order_correction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f20597a43b0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate wavenumber mismatch\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    \n    # Introduce a phase modulation term derived from the domain structure\n    phase_modulation = params[1] * np.sin(params[2] * width)\n    \n    # Adjusted sinc function to account for the phase shift and broadening effects\n    sinc_component = np.sinc((k_mismatch + phase_modulation) / (params[3]))\n    \n    # Enhanced nonlinear interaction term considering both phase modulation and sinc component\n    nonlinear_effect = params[4] * sinc_component**2 * np.cos(params[5] * wavelength)\n    \n    # Gaussian broadening to simulate the effect of domain width on SHG efficiency\n    gaussian_broadening = np.exp(-width**2 / (2 * params[6]**2))\n    \n    # Corrected background correction term with additional physical insights\n    background_correction = params[7] * wavelength**(-params[8]) + params[9] * width**(-params[10]) + params[11] * np.exp(-k_mismatch**2 / (2 * params[12]**2))\n    \n    # Final SHG efficiency calculation incorporating all physical effects\n    shg_efficiency = nonlinear_effect * gaussian_broadening - background_correction + params[13] * k_mismatch**2\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 18, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate wavenumber mismatch\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    \n    # Introduce a phase modulation term derived from the domain structure\n    phase_modulation = params[1] * np.sin(params[2] * width)\n    \n    # Adjusted sinc function to account for the phase shift and broadening effects\n    sinc_component = np.sinc((k_mismatch + phase_modulation) / (params[3]))\n    \n    # Enhanced nonlinear interaction term considering both phase modulation and sinc component\n    nonlinear_effect = params[4] * sinc_component**2 * np.cos(params[5] * wavelength)\n    \n    # Gaussian broadening to simulate the effect of domain width on SHG efficiency\n    gaussian_broadening = np.exp(-width**2 / (2 * params[6]**2))\n    \n    # Corrected background correction term with additional physical insights\n    background_correction = params[7] * wavelength**(-params[8]) + params[9] * width**(-params[10]) + params[11] * np.exp(-k_mismatch**2 / (2 * params[12]**2))\n    \n    # Final SHG efficiency calculation incorporating all physical effects\n    shg_efficiency = nonlinear_effect * gaussian_broadening - background_correction + params[13] * k_mismatch**2\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f205b3216d0: Non-finite scores detected. Problematic clusters -> [index 38: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    # Calculate the fundamental frequency mismatch parameter
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    # Define the sinc-like function component with phase shift and broadening consideration
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))
    # Calculate the Gaussian decay factor considering nonlinear broadening effects
    gaussian_decay = np.exp(-width**2 / (2 * params[3]**2))
    # Account for SRS effect with wavelength dependency and k-mismatch correction, refined term
    srs_effect = params[4] * wavelength**(-params[5]) * np.cos(params[6] * k_mismatch)
    # Incorporate higher-order corrections dependent on domain width, adjusted term
    higher_order_correction = params[7] * (width / params[8])**(-params[9])
    # Combine all components into the final SHG efficiency expression, ensuring physical accuracy
    shg_efficiency = sinc_component**2 * gaussian_decay + srs_effect + higher_order_correction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 38: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    # Calculate the fundamental frequency mismatch parameter
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    # Define the sinc-like function component with phase shift and broadening consideration
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))
    # Calculate the Gaussian decay factor considering nonlinear broadening effects
    gaussian_decay = np.exp(-width**2 / (2 * params[3]**2))
    # Account for SRS effect with wavelength dependency and k-mismatch correction, refined term
    srs_effect = params[4] * wavelength**(-params[5]) * np.cos(params[6] * k_mismatch)
    # Incorporate higher-order corrections dependent on domain width, adjusted term
    higher_order_correction = params[7] * (width / params[8])**(-params[9])
    # Combine all components into the final SHG efficiency expression, ensuring physical accuracy
    shg_efficiency = sinc_component**2 * gaussian_decay + srs_effect + higher_order_correction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f205b3216d0: Non-finite scores detected. Problematic clusters -> [index 38: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    # Calculate the fundamental frequency mismatch parameter
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    # Define the sinc-like function component with phase shift and broadening consideration
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))
    # Calculate the Gaussian decay factor considering nonlinear broadening effects
    gaussian_decay = np.exp(-width**2 / (2 * params[3]**2))
    # Account for SRS effect with wavelength dependency and k-mismatch correction, refined term
    srs_effect = params[4] * wavelength**(-params[5]) * np.cos(params[6] * k_mismatch)
    # Incorporate higher-order corrections dependent on domain width, adjusted term
    higher_order_correction = params[7] * (width / params[8])**(-params[9])
    # Combine all components into the final SHG efficiency expression, ensuring physical accuracy
    shg_efficiency = sinc_component**2 * gaussian_decay + srs_effect + higher_order_correction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 38: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    # Calculate the fundamental frequency mismatch parameter
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    # Define the sinc-like function component with phase shift and broadening consideration
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))
    # Calculate the Gaussian decay factor considering nonlinear broadening effects
    gaussian_decay = np.exp(-width**2 / (2 * params[3]**2))
    # Account for SRS effect with wavelength dependency and k-mismatch correction, refined term
    srs_effect = params[4] * wavelength**(-params[5]) * np.cos(params[6] * k_mismatch)
    # Incorporate higher-order corrections dependent on domain width, adjusted term
    higher_order_correction = params[7] * (width / params[8])**(-params[9])
    # Combine all components into the final SHG efficiency expression, ensuring physical accuracy
    shg_efficiency = sinc_component**2 * gaussian_decay + srs_effect + higher_order_correction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f205b3216d0: Non-finite scores detected. Problematic clusters -> [index 38: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    # Calculate the fundamental frequency mismatch parameter
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    # Define the sinc-like function component with phase shift and broadening consideration
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))
    # Calculate the Gaussian decay factor considering nonlinear broadening effects
    gaussian_decay = np.exp(-width**2 / (2 * params[3]**2))
    # Account for SRS effect with wavelength dependency and k-mismatch correction, refined term
    srs_effect = params[4] * wavelength**(-params[5]) * np.cos(params[6] * k_mismatch)
    # Incorporate higher-order corrections dependent on domain width, adjusted term
    higher_order_correction = params[7] * (width / params[8])**(-params[9])
    # Combine all components into the final SHG efficiency expression, ensuring physical accuracy
    shg_efficiency = sinc_component**2 * gaussian_decay + srs_effect + higher_order_correction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 38: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    # Calculate the fundamental frequency mismatch parameter
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    # Define the sinc-like function component with phase shift and broadening consideration
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))
    # Calculate the Gaussian decay factor considering nonlinear broadening effects
    gaussian_decay = np.exp(-width**2 / (2 * params[3]**2))
    # Account for SRS effect with wavelength dependency and k-mismatch correction, refined term
    srs_effect = params[4] * wavelength**(-params[5]) * np.cos(params[6] * k_mismatch)
    # Incorporate higher-order corrections dependent on domain width, adjusted term
    higher_order_correction = params[7] * (width / params[8])**(-params[9])
    # Combine all components into the final SHG efficiency expression, ensuring physical accuracy
    shg_efficiency = sinc_component**2 * gaussian_decay + srs_effect + higher_order_correction
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f2059616630: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    nonlinear_effect = params[3] * sinc_component**2\n    gaussian_broadening = np.exp(-width**2 / (2 * params[4]**2))\n    background_correction = params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8])\n    temperature_effect = params[9] * np.exp(-params[10] * k_mismatch**2)\n    shg_efficiency = nonlinear_effect * gaussian_broadening - background_correction + temperature_effect\n    return np.abs(shg_efficiency)')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 9, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    nonlinear_effect = params[3] * sinc_component**2\n    gaussian_broadening = np.exp(-width**2 / (2 * params[4]**2))\n    background_correction = params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8])\n    temperature_effect = params[9] * np.exp(-params[10] * k_mismatch**2)\n    shg_efficiency = nonlinear_effect * gaussian_broadening - background_correction + temperature_effect\n    return np.abs(shg_efficiency)')
Error during mutation/evaluation for island 0x7f205b3216d0: Non-finite scores detected. Problematic clusters -> [index 38: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    # Calculate the fundamental frequency mismatch parameter
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    # Define the sinc-like function component with phase shift and broadening consideration
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))
    # Calculate the Gaussian decay factor considering nonlinear broadening effects
    gaussian_decay = np.exp(-width**2 / (2 * params[3]**2))
    # Account for SRS effect with wavelength dependency and k-mismatch correction, refined term
    srs_effect = params[4] * wavelength**(-params[5]) * np.cos(params[6] * k_mismatch)
    # Incorporate higher-order corrections dependent on domain width, adjusted term
    higher_order_correction = params[7] * (width / params[8])**(-params[9])
    # Combine all components into the final SHG efficiency expression, ensuring physical accuracy
    shg_efficiency = sinc_component**2 * gaussian_decay + srs_effect + higher_order_correction
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 38: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    # Calculate the fundamental frequency mismatch parameter
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    # Define the sinc-like function component with phase shift and broadening consideration
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))
    # Calculate the Gaussian decay factor considering nonlinear broadening effects
    gaussian_decay = np.exp(-width**2 / (2 * params[3]**2))
    # Account for SRS effect with wavelength dependency and k-mismatch correction, refined term
    srs_effect = params[4] * wavelength**(-params[5]) * np.cos(params[6] * k_mismatch)
    # Incorporate higher-order corrections dependent on domain width, adjusted term
    higher_order_correction = params[7] * (width / params[8])**(-params[9])
    # Combine all components into the final SHG efficiency expression, ensuring physical accuracy
    shg_efficiency = sinc_component**2 * gaussian_decay + srs_effect + higher_order_correction
    return shg_efficiency']
<ast>:9: RuntimeWarning: overflow encountered in exp
/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_numdiff.py:596: RuntimeWarning: invalid value encountered in subtract
  df = fun(x1) - f0
<ast>:9: RuntimeWarning: overflow encountered in exp
<ast>:9: RuntimeWarning: overflow encountered in exp
/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_numdiff.py:596: RuntimeWarning: invalid value encountered in subtract
  df = fun(x1) - f0
<ast>:9: RuntimeWarning: overflow encountered in exp
<ast>:9: RuntimeWarning: overflow encountered in exp
/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_numdiff.py:596: RuntimeWarning: invalid value encountered in subtract
  df = fun(x1) - f0
<ast>:9: RuntimeWarning: overflow encountered in exp
Error during mutation/evaluation for island 0x7f20597c0e30: ('提供されたソースコードのパースに失敗しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * \\pi / wavelength - 2 * \\pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    non_linear_effect = params[3] * sinc_component**2\n    higher_order_interactions = params[4] * wavelength**(-params[5]) + params[6] * width**(-params[7])\n    phase_matching_effect = params[8] * k_mismatch**2\n    shg_efficiency = non_linear_effect + higher_order_interactions + phase_matching_effect\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 17, in __init__
    node = ast.parse(fn_code)
           ^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/ast.py", line 52, in parse
    return compile(source, filename, mode, flags,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<unknown>", line 2
    k_mismatch = 2 * \pi / wavelength - 2 * \pi / (params[0] * width)
                      ^
SyntaxError: unexpected character after line continuation character

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 258, in request_mutation
    new_fn = self._mutation_engine.mutate(sample_fns)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/llmsr/py_mutation_engine.py", line 80, in mutate
    new_skeleton = function.PyAstSkeleton(fn_code)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 20, in __init__
    raise ValueError("提供されたソースコードのパースに失敗しました", fn_code) from e
ValueError: ('提供されたソースコードのパースに失敗しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * \\pi / wavelength - 2 * \\pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    non_linear_effect = params[3] * sinc_component**2\n    higher_order_interactions = params[4] * wavelength**(-params[5]) + params[6] * width**(-params[7])\n    phase_matching_effect = params[8] * k_mismatch**2\n    shg_efficiency = non_linear_effect + higher_order_interactions + phase_matching_effect\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f20597a56d0: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / broadening_factor)\n    nonlinear_effect = params[3] * sinc_component**2\n    gaussian_broadening = np.exp(-width**2 / (2 * params[4]**2))\n    background_correction = params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8])\n    shg_efficiency = nonlinear_effect * gaussian_broadening - background_correction + params[9] * np.abs(k_mismatch)**(2 * params[10])\n    return np.clip(shg_efficiency, 0, None)')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 9, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / broadening_factor)\n    nonlinear_effect = params[3] * sinc_component**2\n    gaussian_broadening = np.exp(-width**2 / (2 * params[4]**2))\n    background_correction = params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8])\n    shg_efficiency = nonlinear_effect * gaussian_broadening - background_correction + params[9] * np.abs(k_mismatch)**(2 * params[10])\n    return np.clip(shg_efficiency, 0, None)')
Error during mutation/evaluation for island 0x7f20597a6690: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the fundamental frequency mismatch parameter\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    \n    # Define the sinc-like function component with phase shift and broadening consideration\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    \n    # Calculate nonlinear effect\n    nonlinear_effect = params[3] * sinc_component**2\n    \n    # Gaussian broadening term to account for spatial effects\n    gaussian_broadening = np.exp(-width**2 / (2 * params[4]**2))\n    \n    # Background correction terms considering wavelength and width dependencies\n    background_correction = params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8])\n    \n    # Higher-order interaction term that could represent effects like cubic nonlinearity\n    higher_order_interaction = params[9] * k_mismatch**2\n    \n    # Calculate SHG efficiency with improved physical accuracy by combining the above components\n    shg_efficiency = (nonlinear_effect * gaussian_broadening - background_correction + higher_order_interaction) * np.cos(params[10] * wavelength)**2\n    \n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 23, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    # Calculate the fundamental frequency mismatch parameter\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    \n    # Define the sinc-like function component with phase shift and broadening consideration\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    \n    # Calculate nonlinear effect\n    nonlinear_effect = params[3] * sinc_component**2\n    \n    # Gaussian broadening term to account for spatial effects\n    gaussian_broadening = np.exp(-width**2 / (2 * params[4]**2))\n    \n    # Background correction terms considering wavelength and width dependencies\n    background_correction = params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8])\n    \n    # Higher-order interaction term that could represent effects like cubic nonlinearity\n    higher_order_interaction = params[9] * k_mismatch**2\n    \n    # Calculate SHG efficiency with improved physical accuracy by combining the above components\n    shg_efficiency = (nonlinear_effect * gaussian_broadening - background_correction + higher_order_interaction) * np.cos(params[10] * wavelength)**2\n    \n    return shg_efficiency')
<ast>:9: RuntimeWarning: invalid value encountered in sqrt
<ast>:9: RuntimeWarning: invalid value encountered in sqrt
<ast>:9: RuntimeWarning: invalid value encountered in sqrt
<ast>:9: RuntimeWarning: invalid value encountered in sqrt
Error during mutation/evaluation for island 0x7f2059617b30: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))\n    non_linear_effect = params[3] * sinc_component**2\n    higher_order_interactions = params[4] * wavelength**(-params[5]) + params[6] * width**(-params[7])\n    phase_matching_effect = params[8] * k_mismatch**2\n    coupling_factor = params[9] * np.cos(params[10] * k_mismatch)**2  # Add a new term for coupling effect\n    shg_efficiency = non_linear_effect + higher_order_interactions + phase_matching_effect + coupling_factor\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 9, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor))\n    non_linear_effect = params[3] * sinc_component**2\n    higher_order_interactions = params[4] * wavelength**(-params[5]) + params[6] * width**(-params[7])\n    phase_matching_effect = params[8] * k_mismatch**2\n    coupling_factor = params[9] * np.cos(params[10] * k_mismatch)**2  # Add a new term for coupling effect\n    shg_efficiency = non_linear_effect + higher_order_interactions + phase_matching_effect + coupling_factor\n    return shg_efficiency')
Error during mutation/evaluation for island 0x7f20597c0e30: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / broadening_factor)\n    non_linear_effect = params[3] * sinc_component**2\n    higher_order_interactions = params[4] * wavelength**(-params[5]) + params[6] * width**(-params[7])\n    phase_matching_effect = params[8] * k_mismatch**2 + params[9] * np.cos(k_mismatch * width)\n    shg_efficiency = non_linear_effect * higher_order_interactions * np.exp(-k_mismatch**2 / (2 * params[10]**2))\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 9, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / broadening_factor)\n    non_linear_effect = params[3] * sinc_component**2\n    higher_order_interactions = params[4] * wavelength**(-params[5]) + params[6] * width**(-params[7])\n    phase_matching_effect = params[8] * k_mismatch**2 + params[9] * np.cos(k_mismatch * width)\n    shg_efficiency = non_linear_effect * higher_order_interactions * np.exp(-k_mismatch**2 / (2 * params[10]**2))\n    return shg_efficiency')
<ast>:5: RuntimeWarning: invalid value encountered in sqrt
<ast>:7: RuntimeWarning: overflow encountered in power
<ast>:7: RuntimeWarning: overflow encountered in multiply
<ast>:7: RuntimeWarning: invalid value encountered in add
<ast>:5: RuntimeWarning: invalid value encountered in sqrt
<ast>:7: RuntimeWarning: overflow encountered in power
<ast>:5: RuntimeWarning: invalid value encountered in sqrt
<ast>:7: RuntimeWarning: overflow encountered in power
<ast>:5: RuntimeWarning: invalid value encountered in sqrt
<ast>:5: RuntimeWarning: invalid value encountered in sqrt
<ast>:5: RuntimeWarning: invalid value encountered in sqrt
<ast>:5: RuntimeWarning: invalid value encountered in sqrt
<ast>:5: RuntimeWarning: invalid value encountered in sqrt
<ast>:5: RuntimeWarning: invalid value encountered in sqrt
Error during mutation/evaluation for island 0x7f20597a6690: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    nonlinear_effect = params[3] * sinc_component**2\n    gaussian_broadening = np.exp(-width**2 / (2 * params[4]**2))\n    background_correction = params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8])\n    higher_order_interaction = params[9] * k_mismatch**2\n    # Introducing a scaling factor to ensure the efficiency remains within a physically realistic range\n    scaling_factor = params[10]\n    shg_efficiency = scaling_factor * (nonlinear_effect * gaussian_broadening - background_correction + higher_order_interaction)\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 11, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / (2 * broadening_factor))\n    nonlinear_effect = params[3] * sinc_component**2\n    gaussian_broadening = np.exp(-width**2 / (2 * params[4]**2))\n    background_correction = params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8])\n    higher_order_interaction = params[9] * k_mismatch**2\n    # Introducing a scaling factor to ensure the efficiency remains within a physically realistic range\n    scaling_factor = params[10]\n    shg_efficiency = scaling_factor * (nonlinear_effect * gaussian_broadening - background_correction + higher_order_interaction)\n    return shg_efficiency')
<ast>:7: RuntimeWarning: overflow encountered in power
<ast>:7: RuntimeWarning: overflow encountered in multiply
<ast>:7: RuntimeWarning: overflow encountered in power
Error during mutation/evaluation for island 0x7f20597c0e30: Non-finite scores detected. Problematic clusters -> [index 7: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor * np.sqrt(params[3])))
    non_linear_effect = params[4] * sinc_component**2
    higher_order_interactions = params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8])
    phase_matching_effect = params[9] * k_mismatch**2 * np.cos(k_mismatch * width)
    shg_efficiency = non_linear_effect + higher_order_interactions + phase_matching_effect
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 7: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor * np.sqrt(params[3])))
    non_linear_effect = params[4] * sinc_component**2
    higher_order_interactions = params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8])
    phase_matching_effect = params[9] * k_mismatch**2 * np.cos(k_mismatch * width)
    shg_efficiency = non_linear_effect + higher_order_interactions + phase_matching_effect
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f20597c0e30: Non-finite scores detected. Problematic clusters -> [index 7: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor * np.sqrt(params[3])))
    non_linear_effect = params[4] * sinc_component**2
    higher_order_interactions = params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8])
    phase_matching_effect = params[9] * k_mismatch**2 * np.cos(k_mismatch * width)
    shg_efficiency = non_linear_effect + higher_order_interactions + phase_matching_effect
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 7: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor * np.sqrt(params[3])))
    non_linear_effect = params[4] * sinc_component**2
    higher_order_interactions = params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8])
    phase_matching_effect = params[9] * k_mismatch**2 * np.cos(k_mismatch * width)
    shg_efficiency = non_linear_effect + higher_order_interactions + phase_matching_effect
    return shg_efficiency']
Error during mutation/evaluation for island 0x7f205964e660: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / broadening_factor)\n    non_linear_effect = params[3] * sinc_component**2\n    higher_order_interactions = params[4] * wavelength**(-params[5]) + params[6] * width**(-params[7])\n    phase_matching_effect = params[8] * k_mismatch**2\n    shg_efficiency = non_linear_effect * (1 + params[9] * np.exp(-(k_mismatch**2 / (4 * params[10]))))\n    return shg_efficiency')
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 39, in __call__
    result = self._func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ast>", line 9, in equation_v2
IndexError: index 10 is out of bounds for axis 0 with size 10

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 260, in request_mutation
    new_score = new_fn.evaluate()
                ^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/default.py", line 39, in evaluate
    self._evaluator(self._skeleton, input) for input in self._evaluation_inputs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 29, in scipy_evaluator
    result = minimize(loss, [1.0]*MAX_NPARAMS, method='BFGS')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_minimize.py", line 733, in minimize
    res = _minimize_bfgs(fun, x0, args, jac, callback, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 1393, in _minimize_bfgs
    sf = _prepare_scalar_function(fun, x0, jac, args=args, epsilon=eps,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_optimize.py", line 291, in _prepare_scalar_function
    sf = ScalarFunction(fun, x0, args, grad, hess,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 223, in __init__
    self._update_fun()
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 295, in _update_fun
    fx = self._wrapped_fun(self.x)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/.venv/lib/python3.12/site-packages/scipy/optimize/_differentiable_functions.py", line 21, in wrapped
    fx = fun(np.copy(x), *args)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/examples/npda_numpy.py", line 25, in loss
    y_pred = skeleton(width, wavelength, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/function/py_ast_skeleton.py", line 42, in __call__
    raise RuntimeError("関数の実行中にエラーが発生しました", self._fn_code) from e
RuntimeError: ('関数の実行中にエラーが発生しました', 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:\n    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)\n    phase_shift = params[1]\n    broadening_factor = params[2]\n    sinc_component = np.sinc((k_mismatch + phase_shift) / broadening_factor)\n    non_linear_effect = params[3] * sinc_component**2\n    higher_order_interactions = params[4] * wavelength**(-params[5]) + params[6] * width**(-params[7])\n    phase_matching_effect = params[8] * k_mismatch**2\n    shg_efficiency = non_linear_effect * (1 + params[9] * np.exp(-(k_mismatch**2 / (4 * params[10]))))\n    return shg_efficiency')
<ast>:5: RuntimeWarning: invalid value encountered in sqrt
<ast>:7: RuntimeWarning: overflow encountered in power
<ast>:5: RuntimeWarning: invalid value encountered in sqrt
<ast>:5: RuntimeWarning: invalid value encountered in sqrt
Error during mutation/evaluation for island 0x7f20597c0e30: Non-finite scores detected. Problematic clusters -> [index 7: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor * np.sqrt(params[3])))
    non_linear_effect = params[4] * sinc_component**2
    higher_order_interactions = params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8])
    phase_matching_effect = params[9] * k_mismatch**2 * np.cos(k_mismatch * width)
    shg_efficiency = non_linear_effect + higher_order_interactions + phase_matching_effect
    return shg_efficiency']
Traceback (most recent call last):
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 113, in _evolve_islands
    _ = future.result(timeout=60)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/vscode/.local/share/uv/python/cpython-3.12.9-linux-x86_64-gnu/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 255, in request_mutation
    sample_clusters = self._select_clusters()
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/mictlan/research/funsearch/src/funsearch/cluster/evolver.py", line 215, in _select_clusters
    raise ValueError(
ValueError: Non-finite scores detected. Problematic clusters -> [index 7: 'def equation_v2(width: np.ndarray, wavelength: np.ndarray, params: np.ndarray) -> np.ndarray:
    k_mismatch = 2 * np.pi / wavelength - 2 * np.pi / (params[0] * width)
    phase_shift = params[1]
    broadening_factor = params[2]
    sinc_component = np.sinc((k_mismatch + phase_shift) / (broadening_factor * np.sqrt(params[3])))
    non_linear_effect = params[4] * sinc_component**2
    higher_order_interactions = params[5] * wavelength**(-params[6]) + params[7] * width**(-params[8])
    phase_matching_effect = params[9] * k_mismatch**2 * np.cos(k_mismatch * width)
    shg_efficiency = non_linear_effect + higher_order_interactions + phase_matching_effect
    return shg_efficiency']
